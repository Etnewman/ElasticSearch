{
  "template" : {
    "mappings" : {
      "properties" : {
        "@timestamp" : {
          "type" : "date"
        },
        "@version" : {
          "type" : "keyword"
        },
        "agent" : {
          "properties" : {
            "ephemeral_id" : {
              "type" : "keyword"
            },
            "id" : {
              "type" : "keyword"
            },
            "name" : {
              "type" : "keyword"
            },
            "type" : {
              "type" : "keyword"
            },
            "version" : {
              "type" : "keyword"
            }
          }
        },
        "ecs" : {
          "properties" : {
            "version" : {
              "type" : "keyword"
            }
          }
        },
        "elasticsearch" : {
          "properties" : {
            "audit" : {
              "properties" : {
                "action" : {
                  "type" : "keyword"
                },
                "apikey" : {
                  "properties" : {
                    "id" : {
                      "type" : "keyword"
                    },
                    "name" : {
                      "type" : "keyword"
                    }
                  }
                },
                "authentication" : {
                  "properties" : {
                    "type" : {
                      "type" : "keyword"
                    }
                  }
                },
                "event" : {
                  "type" : "object"
                },
                "indices" : {
                  "type" : "keyword"
                },
                "layer" : {
                  "type" : "keyword"
                },
                "opaque_id" : {
                  "type" : "keyword"
                },
                "origin" : {
                  "properties" : {
                    "type" : {
                      "type" : "keyword"
                    }
                  }
                },
                "realm" : {
                  "type" : "keyword"
                },
                "request" : {
                  "properties" : {
                    "id" : {
                      "type" : "keyword"
                    },
                    "method" : {
                      "type" : "keyword"
                    },
                    "name" : {
                      "type" : "keyword"
                    }
                  }
                },
                "url" : {
                  "type" : "object"
                },
                "user" : {
                  "properties" : {
                    "name" : {
                      "type" : "keyword"
                    },
                    "realm" : {
                      "type" : "keyword"
                    },
                    "roles" : {
                      "type" : "keyword",
                        "ignore_above" : 256
                    }
                  }
                },
                "x_forwarded_for" : {
                  "type" : "keyword",
                    "ignore_above" : 256
                }
              }
            },
            "node" : {
              "properties" : {
                "id" : {
                  "type" : "keyword"
                }
              }
            }
          }
        },
        "error" : {
          "properties" : {
            "code" : {
              "type" : "keyword"
            },
            "message" : {
              "type" : "keyword"
            }
          }
        },
        "event" : {
          "properties" : {
            "action" : {
              "type" : "keyword"
            },
            "category" : {
              "type" : "keyword"
            },
            "created" : {
              "type" : "date"
            },
            "dataset" : {
              "type" : "keyword"
            },
            "ingested" : {
              "type" : "date"
            },
            "kind" : {
              "type" : "keyword"
            },
            "module" : {
              "type" : "keyword"
            },
            "original" : {
              "type" : "keyword"
            },
            "outcome" : {
              "type" : "keyword"
            },
            "timezone" : {
              "type" : "keyword"
            },
            "type" : {
              "type" : "keyword"
            }
          }
        },
        "fileset" : {
          "properties" : {
            "name" : {
              "type" : "keyword"
            }
          }
        },
        "host" : {
          "properties" : {
            "id" : {
              "type" : "keyword"
            },
            "name" : {
              "type" : "keyword"
            }
          }
        },
        "http" : {
          "properties" : {
            "request" : {
              "properties" : {
                "id" : {
                  "type" : "keyword"
                },
                "method" : {
                  "type" : "keyword"
                }
              }
            }
          }
        },
        "input" : {
          "properties" : {
            "type" : {
              "type" : "keyword"
            }
          }
        },
        "kibana" : {
          "properties" : {
            "saved_object" : {
              "properties" : {
                "id" : {
                  "type" : "keyword"
                },
                "type" : {
                  "type" : "keyword"
                }
              }
            },
            "session_id" : {
              "type" : "keyword"
            },
            "space_id" : {
              "type" : "keyword"
            }
          }
        },
        "log" : {
          "properties" : {
            "file" : {
              "properties" : {
                "path" : {
                  "type" : "keyword"
                }
              }
            },
            "offset" : {
              "type" : "long"
            }
          }
        },
        "message" : {
          "type" : "keyword"
        },
        "process" : {
          "properties" : {
            "pid" : {
              "type" : "long"
            }
          }
        },
        "related" : {
          "properties" : {
            "user" : {
              "type" : "keyword"
            }
          }
        },
        "service" : {
          "properties" : {
            "type" : {
              "type" : "keyword"
            }
          }
        },
        "source" : {
          "properties" : {
            "address" : {
              "type" : "keyword"
            },
            "ip" : {
              "type" : "keyword"
            },
            "port" : {
              "type" : "long"
            }
          }
        },
        "tags" : {
          "type" : "keyword"
        },
        "trace" : {
          "properties" : {
            "id" : {
              "type" : "keyword"
            }
          }
        },
        "url" : {
          "properties" : {
            "domain" : {
              "type" : "keyword"
            },
            "original" : {
              "type" : "keyword"
            },
            "path" : {
              "type" : "keyword"
            },
            "port" : {
              "type" : "long"
            },
            "query" : {
              "type" : "keyword"
            },
            "scheme" : {
              "type" : "keyword"
            }
          }
        },
        "user" : {
          "properties" : {
            "hash" : {
              "type" : "keyword"
            },
            "id" : {
              "type" : "keyword"
            },
            "name" : {
              "type" : "keyword"
            },
            "roles" : {
              "type" : "keyword"
            }
          }
        }
      }
    }
  }
}
