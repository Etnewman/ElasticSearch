{
    "description" : "Pipeline for Windows Security events",
    "processors" : [
      {
        "set" : {
          "value" : "security",
          "field" : "event.module"
        }
      },
      {
        "convert" : {
          "type" : "string",
          "ignore_missing" : true,
          "field" : "event.code"
        }
      },
      {
        "script" : {
          "ignore_failure" : false,
          "tag" : "Set ECS categorization fields",
          "description" : "Set ECS categorization fields",
          "params" : {
            "4707" : {
              "type" : [
                "deletion"
              ],
              "action" : "domain-trust-removed",
              "category" : [
                "configuration"
              ]
            },
            "4706" : {
              "category" : [
                "configuration"
              ],
              "type" : [
                "creation"
              ],
              "action" : "domain-trust-added"
            },
            "4717" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "system-security-access-granted"
            },
            "4745" : {
              "action" : "changed-distribution-group-account",
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ]
            },
            "4740" : {
              "type" : [
                "user",
                "change"
              ],
              "action" : "locked-out-user-account",
              "category" : [
                "iam"
              ]
            },
            "4714" : {
              "category" : [
                "configuration"
              ],
              "type" : [
                "change"
              ],
              "action" : "encrypted-data-recovery-policy-changed"
            },
            "4722" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "change"
              ],
              "action" : "enabled-user-account"
            },
            "4762" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "removed-member-from-distribution-group"
            },
            "4799" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "info"
              ],
              "action" : "user-member-enumerated"
            },
            "4718" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "deletion"
              ],
              "action" : "system-security-access-removed"
            },
            "4737" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "modified-group-account"
            },
            "4778" : {
              "category" : [
                "authentication",
                "session"
              ],
              "type" : [
                "start"
              ],
              "action" : "session-reconnected"
            },
            "4759" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "creation"
              ],
              "action" : "added-distribution-group-account"
            },
            "1100" : {
              "category" : [
                "process"
              ],
              "type" : [
                "end"
              ],
              "action" : "logging-service-shutdown"
            },
            "4673" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "admin"
              ],
              "action" : "privileged-service-called"
            },
            "4744" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "creation"
              ],
              "action" : "added-distribution-group-account"
            },
            "5140" : {
              "type" : [
                "info",
                "access"
              ],
              "action" : "network-share-object-accessed",
              "category" : [
                "network",
                "file"
              ]
            },
            "4758" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "deletion"
              ],
              "action" : "deleted-group-account"
            },
            "4648" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "start"
              ],
              "action" : "logged-in-explicit"
            },
            "4954" : {
              "action" : "windows-firewall-group-policy-changed",
              "category" : [
                "configuration"
              ],
              "type" : [
                "change"
              ]
            },
            "4697" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "service-installed"
            },
            "4908" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "special-group-table-changed"
            },
            "4748" : {
              "type" : [
                "group",
                "deletion"
              ],
              "action" : "deleted-distribution-group-account",
              "category" : [
                "iam"
              ]
            },
            "4727" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "creation"
              ],
              "action" : "added-group-account"
            },
            "4761" : {
              "action" : "added-member-to-distribution-group",
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ]
            },
            "4699" : {
              "type" : [
                "deletion",
                "admin"
              ],
              "action" : "scheduled-task-deleted",
              "category" : [
                "iam",
                "configuration"
              ]
            },
            "4754" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "creation"
              ],
              "action" : "added-group-account"
            },
            "4738" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "change"
              ],
              "action" : "modified-user-account"
            },
            "4700" : {
              "action" : "scheduled-task-enabled",
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "change",
                "admin"
              ]
            },
            "4912" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "per-user-audit-policy-changed"
            },
            "4743" : {
              "type" : [
                "deletion",
                "admin"
              ],
              "action" : "deleted-computer-account",
              "category" : [
                "iam"
              ]
            },
            "4730" : {
              "action" : "deleted-group-account",
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "deletion"
              ]
            },
            "4715" : {
              "category" : [
                "configuration"
              ],
              "type" : [
                "change"
              ],
              "action" : "object-audit-policy-changed"
            },
            "4756" : {
              "type" : [
                "group",
                "change"
              ],
              "action" : "added-member-to-group",
              "category" : [
                "iam"
              ]
            },
            "1105" : {
              "type" : [
                "admin"
              ],
              "action" : "auditlog-archieved",
              "category" : [
                "iam"
              ]
            },
            "4964" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "admin",
                "group"
              ],
              "action" : "logged-in-special"
            },
            "4776" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "start"
              ],
              "action" : "credential-validated"
            },
            "1108" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "admin"
              ],
              "action" : "logging-processing-error"
            },
            "4720" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "creation"
              ],
              "action" : "added-user-account"
            },
            "4731" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "creation"
              ],
              "action" : "added-group-account"
            },
            "4713" : {
              "category" : [
                "configuration"
              ],
              "type" : [
                "change"
              ],
              "action" : "kerberos-policy-changed"
            },
            "4771" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "start"
              ],
              "action" : "kerberos-preauth-failed"
            },
            "5145" : {
              "type" : [
                "info",
                "access"
              ],
              "action" : "network-share-object-access-checked",
              "category" : [
                "network",
                "file"
              ]
            },
            "4905" : {
              "type" : [
                "admin",
                "deletion"
              ],
              "action" : "security-event-source-removed",
              "category" : [
                "iam",
                "configuration"
              ]
            },
            "5381" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "info"
              ],
              "action" : "vault-credentials-were-read"
            },
            "4746" : {
              "action" : "added-member-to-distribution-group",
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ]
            },
            "4764" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "type-changed-group-account"
            },
            "4817" : {
              "action" : "object-audit-changed",
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ]
            },
            "4716" : {
              "category" : [
                "configuration"
              ],
              "type" : [
                "change"
              ],
              "action" : "trusted-domain-information-changed"
            },
            "4702" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "change",
                "admin"
              ],
              "action" : "scheduled-task-updated"
            },
            "4751" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "added-member-to-distribution-group"
            },
            "4689" : {
              "type" : [
                "end"
              ],
              "action" : "exited-process",
              "category" : [
                "process"
              ]
            },
            "4647" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "end"
              ],
              "action" : "logged-out"
            },
            "4616" : {
              "type" : [
                "change"
              ],
              "action" : "system-time-changed",
              "category" : [
                "configuration"
              ]
            },
            "5024" : {
              "category" : [
                "process"
              ],
              "type" : [
                "start"
              ],
              "action" : "windows-firewall-service-started"
            },
            "4728" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "added-member-to-group"
            },
            "4672" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "admin"
              ],
              "action" : "logged-in-special"
            },
            "5380" : {
              "type" : [
                "user",
                "info"
              ],
              "action" : "vault-credential-find",
              "category" : [
                "iam"
              ]
            },
            "4797" : {
              "type" : [
                "user",
                "info"
              ],
              "action" : "query-existence-of-blank-password",
              "category" : [
                "iam"
              ]
            },
            "4733" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "removed-member-from-group"
            },
            "4614" : {
              "category" : [
                "configuration"
              ],
              "type" : [
                "access"
              ],
              "action" : "notification-package-loaded"
            },
            "4902" : {
              "action" : "user-audit-policy-created",
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "creation"
              ]
            },
            "4701" : {
              "action" : "scheduled-task-disabled",
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "change",
                "admin"
              ]
            },
            "1102" : {
              "type" : [
                "admin",
                "change"
              ],
              "action" : "audit-log-cleared",
              "category" : [
                "iam"
              ]
            },
            "4757" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "removed-member-from-group"
            },
            "4906" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "crash-on-audit-changed"
            },
            "4657" : {
              "type" : [
                "change"
              ],
              "action" : "registry-value-modified",
              "category" : [
                "registry",
                "configuration"
              ]
            },
            "4741" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "creation",
                "admin"
              ],
              "action" : "added-computer-account"
            },
            "4950" : {
              "action" : "windows-firewall-setting-changed",
              "category" : [
                "configuration"
              ],
              "type" : [
                "change"
              ]
            },
            "4760" : {
              "action" : "changed-distribution-group-account",
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ]
            },
            "4907" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "audit-setting-changed"
            },
            "4798" : {
              "type" : [
                "user",
                "info"
              ],
              "action" : "group-membership-enumerated",
              "category" : [
                "iam"
              ]
            },
            "4749" : {
              "type" : [
                "group",
                "creation"
              ],
              "action" : "added-distribution-group-account",
              "category" : [
                "iam"
              ]
            },
            "1104" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "admin"
              ],
              "action" : "logging-full"
            },
            "4726" : {
              "action" : "deleted-user-account",
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "deletion"
              ]
            },
            "5025" : {
              "type" : [
                "end"
              ],
              "action" : "windows-firewall-service-stopped",
              "category" : [
                "process"
              ]
            },
            "4622" : {
              "type" : [
                "access"
              ],
              "action" : "security-package-loaded",
              "category" : [
                "configuration"
              ]
            },
            "4723" : {
              "type" : [
                "user",
                "change"
              ],
              "action" : "changed-password",
              "category" : [
                "iam"
              ]
            },
            "4725" : {
              "type" : [
                "user",
                "deletion"
              ],
              "action" : "disabled-user-account",
              "category" : [
                "iam"
              ]
            },
            "4770" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "start"
              ],
              "action" : "kerberos-service-ticket-renewed"
            },
            "4763" : {
              "type" : [
                "group",
                "deletion"
              ],
              "action" : "deleted-distribution-group-account",
              "category" : [
                "iam"
              ]
            },
            "4742" : {
              "type" : [
                "change",
                "admin"
              ],
              "action" : "changed-computer-account",
              "category" : [
                "iam"
              ]
            },
            "4634" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "end"
              ],
              "action" : "logged-out"
            },
            "4779" : {
              "type" : [
                "end"
              ],
              "action" : "session-disconnected",
              "category" : [
                "authentication",
                "session"
              ]
            },
            "4781" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "change"
              ],
              "action" : "renamed-user-account"
            },
            "4719" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "changed-audit-config"
            },
            "4624" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "start"
              ],
              "action" : "logged-in"
            },
            "4739" : {
              "category" : [
                "configuration"
              ],
              "type" : [
                "change"
              ],
              "action" : "domain-policy-changed"
            },
            "4747" : {
              "action" : "removed-member-from-distribution-group",
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ]
            },
            "4674" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "admin"
              ],
              "action" : "privileged-operation"
            },
            "4729" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "removed-member-from-group"
            },
            "4750" : {
              "type" : [
                "group",
                "change"
              ],
              "action" : "changed-distribution-group-account",
              "category" : [
                "iam"
              ]
            },
            "5382" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "info"
              ],
              "action" : "vault-credentials-were-read"
            },
            "4734" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "deletion"
              ],
              "action" : "deleted-group-account"
            },
            "5034" : {
              "category" : [
                "driver"
              ],
              "type" : [
                "end"
              ],
              "action" : "windows-firewall-driver-stopped"
            },
            "5033" : {
              "category" : [
                "driver"
              ],
              "type" : [
                "start"
              ],
              "action" : "windows-firewall-driver-started"
            },
            "4724" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "change"
              ],
              "action" : "reset-password"
            },
            "4610" : {
              "action" : "authentication-package-loaded",
              "category" : [
                "configuration"
              ],
              "type" : [
                "access"
              ]
            },
            "4904" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "security-event-source-added"
            },
            "4698" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "creation",
                "admin"
              ],
              "action" : "scheduled-task-created"
            },
            "5037" : {
              "category" : [
                "driver"
              ],
              "type" : [
                "end"
              ],
              "action" : "windows-firewall-driver-error"
            },
            "4735" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "modified-group-account"
            },
            "4625" : {
              "category" : [
                "authentication"
              ],
              "type" : [
                "start"
              ],
              "action" : "logon-failed"
            },
            "4732" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "added-member-to-group"
            },
            "4755" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "modified-group-account"
            },
            "5379" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "info"
              ],
              "action" : "credential-manager-credentials-were-read"
            },
            "4688" : {
              "action" : "created-process",
              "category" : [
                "process"
              ],
              "type" : [
                "start"
              ]
            },
            "4768" : {
              "type" : [
                "start"
              ],
              "action" : "kerberos-authentication-ticket-requested",
              "category" : [
                "authentication"
              ]
            },
            "4611" : {
              "type" : [
                "change"
              ],
              "action" : "trusted-logon-process-registered",
              "category" : [
                "configuration"
              ]
            },
            "4752" : {
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "change"
              ],
              "action" : "removed-member-from-distribution-group"
            },
            "4769" : {
              "type" : [
                "start"
              ],
              "action" : "kerberos-service-ticket-requested",
              "category" : [
                "authentication"
              ]
            },
            "4767" : {
              "action" : "unlocked-user-account",
              "category" : [
                "iam"
              ],
              "type" : [
                "user",
                "change"
              ]
            },
            "4670" : {
              "category" : [
                "iam",
                "configuration"
              ],
              "type" : [
                "admin",
                "change"
              ],
              "action" : "permissions-changed"
            },
            "4753" : {
              "action" : "deleted-distribution-group-account",
              "category" : [
                "iam"
              ],
              "type" : [
                "group",
                "deletion"
              ]
            }
          },
          "source" : "if (ctx?.event?.code == null || params.get(ctx.event.code) == null) {\n  return;\n}\ndef hm = new HashMap(params.get(ctx.event.code));\nhm.forEach((k, v) -> ctx.event[k] = v);",
          "lang" : "painless"
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Set Logon Type",
          "description" : "Set Logon Type",
          "params" : {
            "9" : "NewCredentials",
            "10" : "RemoteInteractive",
            "2" : "Interactive",
            "3" : "Network",
            "5" : "Service",
            "7" : "Unlock",
            "11" : "CachedInteractive",
            "4" : "Batch",
            "8" : "NetworkCleartext"
          },
          "source" : "if (ctx?.winlog?.event_data?.LogonType == null) {\n  return;\n}\ndef t = params.get(ctx.winlog.event_data.LogonType);\nif (t == null) {\n  return;\n}\nif (ctx?.winlog?.logon == null ) {\n  Map map = new HashMap();\n  ctx.winlog.put(\"logon\", map);\n}\nctx.winlog.logon.put(\"type\", t)"
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Set User Account Control",
          "description" : "Set User Account Control",
          "params" : {
            "0x00004000" : "USER_NOT_DELEGATED",
            "0x00000040" : "USER_INTERDOMAIN_TRUST_ACCOUNT",
            "0x00200000" : "USER_USE_AES_KEYS",
            "0x00000800" : "USER_ENCRYPTED_TEXT_PASSWORD_ALLOWED",
            "0x00080000" : "USER_NO_AUTH_DATA_REQUIRED",
            "0x00000008" : "USER_TEMP_DUPLICATE_ACCOUNT",
            "0x00010000" : "USER_DONT_REQUIRE_PREAUTH",
            "0x00000004" : "USER_PASSWORD_NOT_REQUIRED",
            "0x00001000" : "USER_SMARTCARD_REQUIRED",
            "0x00000002" : "USER_HOME_DIRECTORY_REQUIRED",
            "0x00000020" : "USER_MNS_LOGON_ACCOUNT",
            "0x00040000" : "USER_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION",
            "0x00100000" : "USER_PARTIAL_SECRETS_ACCOUNT",
            "0x00000010" : "USER_NORMAL_ACCOUNT",
            "0x00002000" : "USER_TRUSTED_FOR_DELEGATION",
            "0x00000001" : "USER_ACCOUNT_DISABLED",
            "0x00008000" : "USER_USE_DES_KEY_ONLY",
            "0x00020000" : "USER_PASSWORD_EXPIRED",
            "0x00000080" : "USER_WORKSTATION_TRUST_ACCOUNT",
            "0x00000100" : "USER_SERVER_TRUST_ACCOUNT",
            "0x00000200" : "USER_DONT_EXPIRE_PASSWORD",
            "0x00000400" : "USER_ACCOUNT_AUTO_LOCKED"
          },
          "source" : "if (ctx?.winlog?.event_data?.NewUacValue == null) {\n  return;\n}\nLong newUacValue = Long.decode(ctx.winlog.event_data.NewUacValue);\nArrayList uacResult = new ArrayList();\ndef[] w = new def[] { null };\nfor (long b = 0; b < 32; b++) {\n  long flag = 1L << b;\n  if ((newUacValue.longValue() & flag) == flag) {\n    w[0] = flag;\n    def desc = params[String.format(\"0x%08X\", w)];\n    if (desc != null) {\n      uacResult.add(desc);\n    }\n  }\n}\nif (uacResult.length == 0) {\n  return;\n}\nctx.winlog.event_data.put(\"NewUACList\", uacResult);\nif (ctx?.winlog?.event_data?.UserAccountControl == null) {\n  return;\n}\nArrayList uac_array = new ArrayList();\nfor (elem in ctx.winlog.event_data.UserAccountControl.splitOnToken(\"%%\")) {\n  if (elem.trim().length() > 0) {\n    uac_array.add(elem.trim());\n  }\n}\nctx.winlog.event_data.UserAccountControl = uac_array;"
        }
      },
      {
        "script" : {
          "tag" : "Set Kerberos Ticket Options",
          "description" : "Set Kerberos Ticket Options",
          "params" : {
            "0x00400000" : "Initial",
            "0x02000000" : "Postdated",
            "0x00000020" : "Disable-transited-check",
            "0x40000000" : "Forwardable",
            "0x00020000" : "Request-anonymous",
            "0x00010000" : "Name-canonicalize",
            "0x00000008" : "Enc-tkt-in-skey",
            "0x00200000" : "Pre-authent",
            "0x00000002" : "Renew",
            "0x00040000" : "Ok-as-delegate",
            "0x10000000" : "Proxiable",
            "0x08000000" : "Proxy",
            "0x00000001" : "Validate",
            "0x01000000" : "Invalid",
            "0x00800000" : "Renewable",
            "0x04000000" : "Allow-postdate",
            "0x00000010" : "Renewable-ok",
            "0x20000000" : "Forwarded",
            "0x00100000" : "Opt-hardware-auth",
            "0x00080000" : "Transited-policy-checked"
          },
          "source" : "if (ctx?.winlog?.event_data?.TicketOptions == null) {\n  return;\n}\nLong tOpts = Long.decode(ctx.winlog.event_data.TicketOptions);\nArrayList tDescs = new ArrayList();\ndef[] w = new def[] { null };\nfor (long b = 0; b < 32; b++) {\n  long flag = 1L << b;\n  if ((tOpts.longValue() & flag) == flag) {\n    w[0] = flag;\n    def desc = params[String.format(\"0x%08X\", w)];\n    if (desc != null) {\n      tDescs.add(desc);\n    }\n  }\n}\nif (tDescs.length == 0) {\n  return;\n}\nctx.winlog.event_data.put(\"TicketOptionsDescription\", tDescs);",
          "lang" : "painless",
          "ignore_failure" : false
        }
      },
      {
        "script" : {
          "params" : {
            "0x3" : "DES-CBC-MD5",
            "0x11" : "AES128-CTS-HMAC-SHA1-96",
            "0x12" : "AES256-CTS-HMAC-SHA1-96",
            "0x17" : "RC4-HMAC",
            "0x18" : "RC4-HMAC-EXP",
            "0xffffffff" : "FAIL",
            "0x1" : "DES-CBC-CRC"
          },
          "source" : "if (ctx?.winlog?.event_data?.TicketEncryptionType == null) {\n  return;\n}\nctx.winlog.event_data.put(\"TicketEncryptionTypeDescription\",\n                          params[ctx.winlog.event_data.TicketEncryptionType.toLowerCase()])",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Set Kerberos Encryption Types",
          "description" : "Set Kerberos Encryption Types"
        }
      },
      {
        "script" : {
          "ignore_failure" : false,
          "tag" : "Set Kerberos Ticket Status Codes",
          "description" : "Set Kerberos Ticket Status Codes",
          "params" : {
            "0x8" : "KDC_ERR_PRINCIPAL_NOT_UNIQUE",
            "0xD" : "KDC_ERR_BADOPTION",
            "0x22" : "KRB_AP_ERR_REPEAT",
            "0x2E" : "KRB_AP_ERR_MUT_FAIL",
            "0x3F" : "KDC_ERR_KDC_NOT_TRUSTED",
            "0x23" : "KRB_AP_ERR_NOT_US",
            "0x12" : "KDC_ERR_CLIENT_REVOKED",
            "0x27" : "KRB_AP_ERR_BADVERSION",
            "0x20" : "KRB_AP_ERR_TKT_EXPIRED",
            "0x28" : "KRB_AP_ERR_MSG_TYPE",
            "0x29" : "KRB_AP_ERR_MODIFIED",
            "0x2A" : "KRB_AP_ERR_BADORDER",
            "0x18" : "KDC_ERR_PREAUTH_FAILED",
            "0x43" : "KRB_AP_ERR_NO_TGT",
            "0xE" : "KDC_ERR_ETYPE_NOTSUPP",
            "0x2C" : "KRB_AP_ERR_BADKEYVER",
            "0x1A" : "KDC_ERR_SERVER_NOMATCH",
            "0x0" : "KDC_ERR_NONE",
            "0x26" : "KRB_AP_ERR_BADADDR",
            "0x3E" : "KDC_ERR_CLIENT_NOT_TRUSTED",
            "0x42" : "KRB_AP_ERR_USER_TO_USER_REQUIRED",
            "0x2" : "KDC_ERR_SERVICE_EXP",
            "0x13" : "KDC_ERR_SERVICE_REVOKED",
            "0x41" : "KDC_ERR_KEY_TOO_WEAK",
            "0x3C" : "KRB_ERR_GENERIC",
            "0x9" : "KDC_ERR_NULL_KEY",
            "0x19" : "KDC_ERR_PREAUTH_REQUIRED",
            "0x1" : "KDC_ERR_NAME_EXP",
            "0x3" : "KDC_ERR_BAD_PVNO",
            "0x5" : "KDC_ERR_S_OLD_MAST_KVNO",
            "0xB" : "KDC_ERR_NEVER_VALID",
            "0x3D" : "KRB_ERR_FIELD_TOOLONG",
            "0x17" : "KDC_ERR_KEY_EXPIRED",
            "0x16" : "KDC_ERR_SERVICE_NOTYET",
            "0x2F" : "KRB_AP_ERR_BADDIRECTION",
            "0xC" : "KDC_ERR_POLICY",
            "0x25" : "KRB_AP_ERR_SKEW",
            "0x24" : "KRB_AP_ERR_BADMATCH",
            "0x6" : "KDC_ERR_C_PRINCIPAL_UNKNOWN",
            "0x1B" : "KDC_ERR_MUST_USE_USER2USER",
            "0x21" : "KRB_AP_ERR_TKT_NYV",
            "0x34" : "KRB_ERR_RESPONSE_TOO_BIG",
            "0x40" : "KDC_ERR_INVALID_SIG",
            "0x14" : "KDC_ERR_TGT_REVOKED",
            "0x11" : "KDC_ERR_TRTYPE_NO_SUPP",
            "0x10" : "KDC_ERR_PADATA_TYPE_NOSUPP",
            "0x1F" : "KRB_AP_ERR_BAD_INTEGRITY",
            "0x30" : "KRB_AP_ERR_METHOD",
            "0x31" : "KRB_AP_ERR_BADSEQ",
            "0x15" : "KDC_ERR_CLIENT_NOTYET",
            "0xA" : "KDC_ERR_CANNOT_POSTDATE",
            "0xF" : "KDC_ERR_SUMTYPE_NOSUPP",
            "0x32" : "KRB_AP_ERR_INAPP_CKSUM",
            "0x7" : "KDC_ERR_S_PRINCIPAL_UNKNOWN",
            "0x44" : "KDC_ERR_WRONG_REALM",
            "0x2D" : "KRB_AP_ERR_NOKEY",
            "0x33" : "KRB_AP_PATH_NOT_ACCEPTED",
            "0x4" : "KDC_ERR_C_OLD_MAST_KVNO"
          },
          "source" : "if (ctx?.winlog?.event_data?.Status == null ||\n    ctx?.event?.code == null ||\n    ![\"4768\", \"4769\", \"4770\", \"4771\"].contains(ctx.event.code)) {\n  return;\n}\nctx.winlog.event_data.put(\"StatusDescription\", params[ctx.winlog.event_data.Status]);",
          "lang" : "painless"
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Set Service Type and Name",
          "description" : "Set Service Type and Name",
          "params" : {
            "0x1" : "Kernel Driver",
            "0x2" : "File System Driver",
            "0x8" : "Recognizer Driver",
            "0x10" : "Win32 Own Process",
            "0x20" : "Win32 Share Process",
            "0x110" : "Interactive Own Process",
            "0x120" : "Interactive Share Process"
          },
          "source" : "if (ctx?.winlog?.event_data?.ServiceName != null) {\n  if (ctx?.service == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"service\", hm);\n  }\n  ctx.service.put(\"name\", ctx.winlog.event_data.ServiceName);\n}\nif (ctx?.winlog.event_data?.ServiceType != null) {\n  if (ctx?.service == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"service\", hm);\n  }\n  ctx.service.put(\"type\", params[ctx.winlog.event_data.ServiceType]);\n}"
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Set Audit Information",
          "description" : "Set Audit Information",
          "params" : {
            "0CCE923E-69AE-11D9-BED3-505054503030" : [
              "Detailed Directory Service Replication",
              "Account Management"
            ],
            "0CCE922F-69AE-11D9-BED3-505054503030" : [
              "Audit Policy Change",
              "Policy Change"
            ],
            "0CCE921A-69AE-11D9-BED3-505054503030" : [
              "IPsec Extended Mode",
              "Logon/Logoff"
            ],
            "0CCE9245-69AE-11D9-BED3-505054503030" : [
              "Removable Storage",
              "Object Access"
            ],
            "0CCE921D-69AE-11D9-BED3-505054503030" : [
              "File System",
              "Object Access"
            ],
            "0CCE9215-69AE-11D9-BED3-505054503030" : [
              "Logon",
              "Logon/Logoff"
            ],
            "0CCE9219-69AE-11D9-BED3-505054503030" : [
              "IPsec Quick Mode",
              "Logon/Logoff"
            ],
            "0CCE922B-69AE-11D9-BED3-505054503030" : [
              "Process Creation",
              "Detailed Tracking"
            ],
            "0CCE9210-69AE-11D9-BED3-505054503030" : [
              "Security State Change",
              "System"
            ],
            "0CCE921C-69AE-11D9-BED3-505054503030" : [
              "Other Logon/Logoff Events",
              "Logon/Logoff"
            ],
            "0CCE9230-69AE-11D9-BED3-505054503030" : [
              "Authentication Policy Change",
              "Policy Change"
            ],
            "0CCE922A-69AE-11D9-BED3-505054503030" : [
              "Other Privilege Use Events",
              "Privilege Use"
            ],
            "0CCE923A-69AE-11D9-BED3-505054503030" : [
              "Other Account Management Events",
              "Account Management"
            ],
            "0CCE9223-69AE-11D9-BED3-505054503030" : [
              "Handle Manipulation",
              "Object Access"
            ],
            "0CCE9225-69AE-11D9-BED3-505054503030" : [
              "Filtering Platform Packet Drop",
              "Object Access"
            ],
            "0CCE922C-69AE-11D9-BED3-505054503030" : [
              "Process Termination",
              "Detailed Tracking"
            ],
            "0CCE9247-69AE-11D9-BED3-505054503030" : [
              "User / Device Claims",
              "Logon/Logoff"
            ],
            "0CCE9241-69AE-11D9-BED3-505054503030" : [
              "Other Account Logon Events",
              "Account Logon"
            ],
            "0CCE9224-69AE-11D9-BED3-505054503030" : [
              "File Share",
              "Object Access"
            ],
            "0CCE9242-69AE-11D9-BED3-505054503030" : [
              "Kerberos Authentication Service",
              "Account Logon"
            ],
            "0CCE9214-69AE-11D9-BED3-505054503030" : [
              "Other System Events",
              "System"
            ],
            "0CCE9227-69AE-11D9-BED3-505054503030" : [
              "Other Object Access Events",
              "Object Access"
            ],
            "0CCE9212-69AE-11D9-BED3-505054503030" : [
              "System Integrity",
              "System"
            ],
            "0CCE922E-69AE-11D9-BED3-505054503030" : [
              "RPC Events",
              "Detailed Tracking"
            ],
            "0CCE9221-69AE-11D9-BED3-505054503030" : [
              "Certification Services",
              "Object Access"
            ],
            "0CCE9243-69AE-11D9-BED3-505054503030" : [
              "Network Policy Server",
              "Logon/Logoff"
            ],
            "0CCE9211-69AE-11D9-BED3-505054503030" : [
              "Security System Extension",
              "System"
            ],
            "0CCE9236-69AE-11D9-BED3-505054503030" : [
              "Computer Account Management",
              "Account Management"
            ],
            "0CCE9246-69AE-11D9-BED3-505054503030" : [
              "Central Policy Staging",
              "Object Access"
            ],
            "0CCE9229-69AE-11D9-BED3-505054503030" : [
              "Non Sensitive Privilege Use",
              "Privilege Use"
            ],
            "0CCE9232-69AE-11D9-BED3-505054503030" : [
              "MPSSVC Rule-Level Policy Change",
              "Policy Change"
            ],
            "0CCE923C-69AE-11D9-BED3-505054503030" : [
              "Directory Service Changes",
              "Account Management"
            ],
            "0CCE9231-69AE-11D9-BED3-505054503030" : [
              "Authorization Policy Change",
              "Policy Change"
            ],
            "0CCE9244-69AE-11D9-BED3-505054503030" : [
              "Detailed File Share",
              "Object Access"
            ],
            "0CCE9235-69AE-11D9-BED3-505054503030" : [
              "User Account Management",
              "Account Management"
            ],
            "0CCE9213-69AE-11D9-BED3-505054503030" : [
              "IPsec Driver",
              "System"
            ],
            "0CCE9217-69AE-11D9-BED3-505054503030" : [
              "Account Lockout",
              "Logon/Logoff"
            ],
            "0CCE9226-69AE-11D9-BED3-505054503030" : [
              "Filtering Platform Connection ",
              "Object Access"
            ],
            "0CCE9220-69AE-11D9-BED3-505054503030" : [
              "SAM",
              "Object Access"
            ],
            "0CCE9233-69AE-11D9-BED3-505054503030" : [
              "Filtering Platform Policy Change",
              "Policy Change"
            ],
            "0CCE9222-69AE-11D9-BED3-505054503030" : [
              "Application Generated",
              "Object Access"
            ],
            "0CCE921B-69AE-11D9-BED3-505054503030" : [
              "Special Logon",
              "Logon/Logoff"
            ],
            "0CCE922D-69AE-11D9-BED3-505054503030" : [
              "DPAPI Activity",
              "Detailed Tracking"
            ],
            "0CCE9238-69AE-11D9-BED3-505054503030" : [
              "Distribution Group Management",
              "Account Management"
            ],
            "0CCE9218-69AE-11D9-BED3-505054503030" : [
              "IPsec Main Mode",
              "Logon/Logoff"
            ],
            "0CCE9240-69AE-11D9-BED3-505054503030" : [
              "Kerberos Service Ticket Operations",
              "Account Logon"
            ],
            "0CCE923B-69AE-11D9-BED3-505054503030" : [
              "Directory Service Access",
              "Account Management"
            ],
            "0CCE9237-69AE-11D9-BED3-505054503030" : [
              "Security Group Management",
              "Account Management"
            ],
            "0CCE921F-69AE-11D9-BED3-505054503030" : [
              "Kernel Object",
              "Object Access"
            ],
            "0CCE923F-69AE-11D9-BED3-505054503030" : [
              "Credential Validation",
              "Account Logon"
            ],
            "0CCE9234-69AE-11D9-BED3-505054503030" : [
              "Other Policy Change Events",
              "Policy Change"
            ],
            "0CCE9216-69AE-11D9-BED3-505054503030" : [
              "Logoff",
              "Logon/Logoff"
            ],
            "0CCE9228-69AE-11D9-BED3-505054503030" : [
              "Sensitive Privilege Use",
              "Privilege Use"
            ],
            "0CCE9248-69AE-11D9-BED3-505054503030" : [
              "Plug and Play Events",
              "Detailed Tracking"
            ],
            "0CCE9239-69AE-11D9-BED3-505054503030" : [
              "Application Group Management",
              "Account Management"
            ],
            "0CCE921E-69AE-11D9-BED3-505054503030" : [
              "Registry",
              "Object Access"
            ],
            "0CCE923D-69AE-11D9-BED3-505054503030" : [
              "Directory Service Replication",
              "Account Management"
            ]
          },
          "source" : "if (ctx?.winlog?.event_data?.SubcategoryGuid == null) {\n  return;\n}\ndef subCatGuid = ctx.winlog.event_data.SubcategoryGuid.replace(\"{\",\"\").replace(\"}\",\"\").toUpperCase();\nif (!params.containsKey(subCatGuid)) {\n  return;\n}\nctx.winlog.event_data.put(\"Category\", params[subCatGuid][1]);\nctx.winlog.event_data.put(\"SubCategory\", params[subCatGuid][0]);"
        }
      },
      {
        "script" : {
          "source" : "def split(String s) {\n  def f = new ArrayList();\n  int last = 0;\n  for (; last < s.length() && Character.isWhitespace(s.charAt(last)); last++) {}\n  for (def i = last; i < s.length(); i++) {\n    if (!Character.isWhitespace(s.charAt(i))) {\n      continue;\n    }\n    f.add(s.substring(last, i));\n    for (; i < s.length() && Character.isWhitespace(s.charAt(i)); i++) {}\n    last = i;\n  }\n  f.add(s.substring(last));\n  return f;\n}\n\nif (ctx?.winlog?.event_data?.FailureReason != null) {\n  def code = ctx.winlog.event_data.FailureReason.replace(\"%%\",\"\");\n  if (params.descriptions.containsKey(code)) {\n    if (ctx?.winlog?.logon == null ) {\n      HashMap hm = new HashMap();\n      ctx.winlog.put(\"logon\", hm);\n    }\n    if (ctx?.winlog?.logon?.failure == null) {\n      HashMap hm = new HashMap();\n      ctx.winlog.logon.put(\"failure\", hm);\n    }\n    ctx.winlog.logon.failure.put(\"reason\", params.descriptions[code]);\n  }\n}\nif (ctx?.winlog?.event_data?.AuditPolicyChanges != null) {\n  ArrayList results = new ArrayList();\n  for (elem in ctx.winlog.event_data.AuditPolicyChanges.splitOnToken(\",\")) {\n    def code = elem.replace(\"%%\",\"\").trim();\n    if (params.descriptions.containsKey(code)) {\n      results.add(params.descriptions[code]);\n    }\n  }\n  if (results.length > 0) {\n    ctx.winlog.event_data.put(\"AuditPolicyChangesDescription\", results);\n  }\n}\nif (ctx?.winlog?.event_data?.AccessList != null) {\n  ArrayList results = new ArrayList();\n  for (elem in split(ctx.winlog.event_data.AccessList)) {\n    def code = elem.replace(\"%%\",\"\").trim();\n    if (params.descriptions.containsKey(code)) {\n      results.add(params.descriptions[code]);\n    }\n  }\n  if (results.length > 0) {\n    ctx.winlog.event_data.put(\"AccessListDescription\", results);\n  }\n}\nif (ctx?.winlog?.event_data?.AccessMask != null) {\n  ArrayList list = new ArrayList();\n  long accessMask;\n  for (elem in split(ctx.winlog.event_data.AccessMask)) {\n    if (elem.length() == 0) {\n      continue;\n    }\n    list.add(elem);\n    def code = elem.replace(\"%%\",\"\").trim();\n    accessMask |= Long.decode(code).longValue();\n  }\n  if (list.length > 0) {\n    ctx.winlog.event_data.put(\"AccessMask\", list);\n  }\n\n  ArrayList desc = new ArrayList();\n  def[] w = new def[] { null };\n  for (long b = 0; b < 32; b++) {\n    long flag = 1L << b;\n    if ((accessMask & flag) == flag) {\n      w[0] = flag;\n      def fDesc = params.AccessMaskDescriptions[String.format(\"0x%08X\", w)];\n      if (fDesc != null) {\n        desc.add(fDesc);\n      }\n    }\n  }\n  if (desc.length > 0) {\n    ctx.winlog.event_data.put(\"AccessMaskDescription\", desc);\n  }\n  ArrayList results = new ArrayList();\n}",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Decode message table",
          "description" : "Decode message table",
          "params" : {
            "descriptions" : {
              "12807" : "Handle Manipulation",
              "4486" : "Duplicate handle into or out of process",
              "4399" : "Undefined Access (no effect) Bit 15",
              "1874" : "REG_EXPAND_SZ",
              "5699" : "Undefined Access (no effect) Bit 3",
              "7184" : "Query service configuration information",
              "2078" : "Undefined UserAccountControl Bit 30' - Disabled",
              "8234" : "DH group ECP 384",
              "4450" : "Undefined Access (no effect) Bit 2",
              "14679" : "No",
              "4423" : "ReadAttributes",
              "4505" : "Undefined Access (no effect) Bit 9",
              "8276" : "Detailed Tracking",
              "5390" : "Undefined Access (no effect) Bit 14",
              "13572" : "Filtering Platform Policy Change",
              "1621" : "View or Change Audit Log Privilege",
              "14600" : "Datagram Data",
              "4500" : "Undefined Access (no effect) Bit 4",
              "8233" : "DH group ECP 256",
              "4515" : "Map section for execute",
              "4865" : "Modify State",
              "7425" : "DDE Share Write",
              "4380" : "Undefined Access (no effect) Bit 12",
              "14678" : "Yes",
              "2072" : "Undefined UserAccountControl Bit 24' - Disabled",
              "7188" : "Start the service",
              "8241" : "SSL ECDSA P384",
              "14675" : "Value Deleted",
              "4579" : "Undefined Access (no effect) Bit 3",
              "5125" : "Undefined Access (no effect) Bit 5",
              "4375" : "Undefined Access (no effect) Bit 7",
              "6676" : "Journal (record)",
              "4382" : "Undefined Access (no effect) Bit 14",
              "1846" : "Default",
              "5137" : "Set Attributes",
              "2076" : "Undefined UserAccountControl Bit 28' - Disabled",
              "4570" : "Undefined Access (no effect) Bit 10",
              "8235" : "AES-128",
              "2107" : "Undefined UserAccountControl Bit 27' - Enabled",
              "2079" : "Undefined UserAccountControl Bit 31' - Disabled",
              "5407" : "Undefined Access (no effect) Bit 15",
              "2492" : "Remove context.",
              "2085" : "MNS Logon Account' - Enabled",
              "5146" : "Undefined Access (no effect) Bit 10",
              "4582" : "Undefined Access (no effect) Bit 6",
              "7170" : "Enumerate services",
              "4534" : "Undefined Access (no effect) Bit 6",
              "5379" : "CreateDomain",
              "5674" : "Undefined Access (no effect) Bit 10",
              "4383" : "Undefined Access (no effect) Bit 15",
              "8065" : "Port sharing (write)",
              "6659" : "Create desktop",
              "4491" : "Set process termination port",
              "14339" : "Kerberos Authentication Service",
              "2051" : "Temp Duplicate Account' - Disabled",
              "4389" : "Undefined Access (no effect) Bit 5",
              "7689" : "Undefined Access (no effect) Bit 9",
              "6948" : "Administer Document",
              "14616" : "Connect Redirect",
              "16402" : "AES-256",
              "5134" : "Undefined Access (no effect) Bit 14",
              "8217" : "Not enabled",
              "5453" : "Undefined Access (no effect) Bit 13",
              "4472" : "Undefined Access (no effect) Bit 8",
              "4602" : "Undefined Access (no effect) Bit 10",
              "5416" : "Undefined Access (no effect) Bit 8",
              "5445" : "WriteAccount",
              "2449" : "Key export checks failed.",
              "5702" : "Undefined Access (no effect) Bit 6",
              "5654" : "Undefined Access (no effect) Bit 6",
              "8220" : "Sent second (SSPI) payload",
              "14081" : "Directory Service Changes",
              "14595" : "Bidirectional",
              "5424" : "AddMember",
              "4506" : "Undefined Access (no effect) Bit 10",
              "12288" : "Security State Change",
              "5439" : "Undefined Access (no effect) Bit 15",
              "4452" : "Undefined Access (no effect) Bit 4",
              "4379" : "Undefined Access (no effect) Bit 11",
              "1552" : "Unknown specific access (bit 0)",
              "1828" : "an ACE too long to display",
              "7192" : "Issue service-specific control commands",
              "4576" : "Query timer state",
              "4561" : "Suspend or resume thread",
              "5690" : "Undefined Access (no effect) Bit 10",
              "2307" : "Account locked out.",
              "12545" : "Logoff",
              "5400" : "ListAccounts",
              "4417" : "WriteData (or AddFile)",
              "4357" : "Device Access Bit 5",
              "7190" : "Pause or continue the service",
              "4451" : "Undefined Access (no effect) Bit 3",
              "16395" : "AES-GCM 128",
              "4360" : "Device Access Bit 8",
              "2080" : "Account Disabled",
              "1616" : "Create Permanent Object Privilege",
              "2098" : "Trusted To Authenticate For Delegation' - Enabled",
              "5147" : "Undefined Access (no effect) Bit 11",
              "1624" : "Remotely Shut System Down Privilege",
              "4433" : "Set key value",
              "1823" : "Sid",
              "5669" : "Undefined Access (no effect) Bit 5",
              "14681" : "Value Deleted With Expiration Time",
              "4525" : "Undefined Access (no effect) Bit 13",
              "5692" : "Undefined Access (no effect) Bit 12",
              "4377" : "Undefined Access (no effect) Bit 9",
              "7684" : "Read Property",
              "4465" : "Undefined Access (no effect) Bit 1",
              "13569" : "Authentication Policy Change",
              "5404" : "Undefined Access (no effect) Bit 12",
              "14688" : "Value Auto Deleted With Expiration Time",
              "4370" : "Create object in directory",
              "4504" : "Undefined Access (no effect) Bit 8",
              "1798" : "None",
              "7680" : "Create Child",
              "5123" : "Channel set information",
              "7432" : "DDE Share Add Items",
              "4536" : "Undefined Access (no effect) Bit 8",
              "13570" : "Authorization Policy Change",
              "4483" : "Perform virtual memory operation",
              "4477" : "Undefined Access (no effect) Bit 13",
              "12808" : "File Share",
              "4608" : "Create instance of object type",
              "13312" : "Process Creation",
              "4598" : "AdjustGroups",
              "4420" : "WriteEA",
              "7191" : "Query information from service",
              "5426" : "ListMembers",
              "2087" : "Workstation Trust Account' - Enabled",
              "4548" : "Undefined Access (no effect) Bit 4",
              "13827" : "Distribution Group Management",
              "8213" : "Tunnel",
              "1824" : "Boolean",
              "1829" : "a Security Descriptor too long to display",
              "4530" : "Undefined Access (no effect) Bit 2",
              "8209" : "Sent final payload",
              "16899" : "Partial Write",
              "5695" : "Undefined Access (no effect) Bit 15",
              "5128" : "Undefined Access (no effect) Bit 8",
              "5139" : "Terminate Job",
              "4457" : "Undefined Access (no effect) Bit 9",
              "4381" : "Undefined Access (no effect) Bit 13",
              "1792" : "<value changed",
              "1556" : "Unknown specific access (bit 4)",
              "4460" : "Undefined Access (no effect) Bit 12",
              "2501" : "Key Derivation.",
              "2071" : "Undefined UserAccountControl Bit 23' - Disabled",
              "8246" : "Authentication payload sent",
              "5670" : "Undefined Access (no effect) Bit 6",
              "5641" : "Administer audit log attributes",
              "5672" : "Undefined Access (no effect) Bit 8",
              "4458" : "Undefined Access (no effect) Bit 10",
              "4573" : "Undefined Access (no effect) Bit 13",
              "2486" : "Secret agreement.",
              "2465" : "Import of persistent cryptographic key.",
              "14624" : "Stream Packet",
              "16898" : "Full Write",
              "1845" : "Not Available",
              "2057" : "Don't Expire Password' - Disabled",
              "5126" : "Undefined Access (no effect) Bit 6",
              "1800" : "<Value change auditing for this registry type is not supported>",
              "5642" : "Enable/Disable LSA",
              "2484" : "Decrypt.",
              "16398" : "DES",
              "5432" : "Undefined Access (no effect) Bit 8",
              "5428" : "WriteAccount",
              "12553" : "User / Device Claims",
              "5708" : "Undefined Access (no effect) Bit 12",
              "4390" : "Undefined Access (no effect) Bit 6",
              "6661" : "Access global atoms",
              "5687" : "Undefined Access (no effect) Bit 7",
              "14593" : "Outbound",
              "4432" : "Query key value",
              "2082" : "Password Not Required' - Enabled",
              "4421" : "Execute/Traverse",
              "1924" : "Thursday",
              "4512" : "Query section state",
              "1615" : "Create Pagefile Privilege",
              "12811" : "Detailed File Share",
              "5420" : "Undefined Access (no effect) Bit 12",
              "4488" : "Set process quotas",
              "4526" : "Undefined Access (no effect) Bit 14",
              "4539" : "Undefined Access (no effect) Bit 11",
              "4471" : "Undefined Access (no effect) Bit 7",
              "16399" : "3DES",
              "4443" : "Undefined Access (no effect) Bit 11",
              "5384" : "Undefined Access (no effect) Bit 8",
              "4474" : "Undefined Access (no effect) Bit 10",
              "1876" : "REG_DWORD",
              "5449" : "ReadGroupMembership",
              "5640" : "Change system audit requirements",
              "13056" : "Sensitive Privilege Use",
              "8210" : "Complete",
              "16397" : "AES-GCM 256",
              "8198" : "SHA1",
              "14680" : "Value Added With Expiration Time",
              "1536" : "Unused message ID",
              "4606" : "Undefined Access (no effect) Bit 14",
              "2496" : "Remove function provider.",
              "1805" : "Not granted",
              "5145" : "Undefined Access (no effect) Bit 9",
              "8204" : "Sent third (ID) payload",
              "1905" : "Existing registry value modified",
              "5648" : "Change secret value",
              "4369" : "Traverse",
              "4464" : "Communicate using port",
              "1881" : "REG_FULL_RESOURCE_DESCRIPTOR",
              "2053" : "MNS Logon Account' - Disabled",
              "5685" : "Undefined Access (no effect) Bit 5",
              "4463" : "Undefined Access (no effect) Bit 15",
              "8452" : "Success include removed",
              "4550" : "Undefined Access (no effect) Bit 6",
              "5691" : "Undefined Access (no effect) Bit 11",
              "12554" : "Group Membership",
              "1562" : "Unknown specific access (bit 10)",
              "12806" : "Application Generated",
              "6665" : "Read screen",
              "14672" : "<Binary>",
              "4509" : "Undefined Access (no effect) Bit 13",
              "1873" : "REG_SZ",
              "5659" : "Undefined Access (no effect) Bit 11",
              "16896" : "Enable WMI Account",
              "12546" : "Account Lockout",
              "1539" : "WRITE_DAC",
              "4575" : "Undefined Access (no effect) Bit 15",
              "8248" : "DH group 24",
              "14601" : "ICMP Error",
              "2054" : "Interdomain Trust Account' - Disabled",
              "5430" : "Undefined Access (no effect) Bit 6",
              "8237" : "AES-256",
              "8211" : "Unknown",
              "4373" : "Undefined Access (no effect) Bit 5",
              "5149" : "Undefined Access (no effect) Bit 13",
              "5408" : "ReadInformation",
              "12801" : "Registry",
              "1796" : "Disabled",
              "5651" : "Undefined Access (no effect) Bit 3",
              "4501" : "Undefined Access (no effect) Bit 5",
              "4619" : "Undefined Access (no effect) Bit 11",
              "5427" : "ReadInformation",
              "5668" : "Change the Posix ID offset assigned to the trusted domain",
              "1848" : "Off",
              "8273" : "Logon/Logoff",
              "4507" : "Undefined Access (no effect) Bit 11",
              "4445" : "Undefined Access (no effect) Bit 13",
              "5130" : "Undefined Access (no effect) Bit 10",
              "1872" : "REG_NONE",
              "14609" : "Listen",
              "1609" : "Take Ownership Privilege",
              "4473" : "Undefined Access (no effect) Bit 9",
              "5393" : "WritePasswordParameters",
              "2451" : "Signature verification failed.",
              "14602" : "MAC 802.3",
              "5636" : "Create special accounts (for assignment of user rights)",
              "1538" : "READ_CONTROL",
              "4388" : "Undefined Access (no effect) Bit 4",
              "2091" : "Encrypted Text Password Allowed' - Enabled",
              "2060" : "Smartcard Required' - Disabled",
              "4384" : "Query event state",
              "1842" : "Yes",
              "2482" : "Delete Key.",
              "2438" : "Failed to zero secret data.",
              "2083" : "Temp Duplicate Account' - Enabled",
              "5441" : "ReadPreferences",
              "4557" : "Undefined Access (no effect) Bit 13",
              "12544" : "Logon",
              "8222" : "IKEv1",
              "1563" : "Unknown specific access (bit 11)",
              "2487" : "Domain settings",
              "5382" : "Undefined Access (no effect) Bit 6",
              "14338" : "Other Account Logon Events",
              "12810" : "Filtering Platform Connection",
              "14083" : "Detailed Directory Service Replication",
              "1612" : "Set System Time Privilege",
              "5679" : "Undefined Access (no effect) Bit 15",
              "16388" : "Not persistent",
              "4623" : "Undefined Access (no effect) Bit 15",
              "4555" : "Undefined Access (no effect) Bit 11",
              "8096" : "Default credentials",
              "12548" : "Special Logon",
              "4446" : "Undefined Access (no effect) Bit 14",
              "4574" : "Undefined Access (no effect) Bit 14",
              "16403" : "Transport",
              "2304" : "An Error occured during Logon.",
              "1937" : "TokenElevationTypeFull (2)",
              "1906" : "Registry value deleted",
              "1922" : "Tuesday",
              "4565" : "Set thread information",
              "8240" : "SSL ECDSA P256",
              "7693" : "Undefined Access (no effect) Bit 13",
              "1555" : "Unknown specific access (bit 3)",
              "4616" : "Undefined Access (no effect) Bit 8",
              "2437" : "Random number generation failed FIPS-140 pre-hash check.",
              "1819" : "Unsigned 64-bit Integer",
              "13571" : "MPSSVC Rule-Level Policy Change",
              "1879" : "REG_MULTI_SZ (New lines are replaced with *. A * is replaced with **)",
              "2480" : "Open Key.",
              "8231" : "DH group 2",
              "5450" : "ChangeGroupMembership",
              "5141" : "Undefined Access (no effect) Bit 5",
              "7940" : "Audit Enumerate Users",
              "8280" : "Account Logon",
              "2489" : "Add provider.",
              "5418" : "Undefined Access (no effect) Bit 10",
              "5392" : "ReadPasswordParameters",
              "2495" : "Add function provider.",
              "5656" : "Undefined Access (no effect) Bit 8",
              "8272" : "System",
              "1803" : "Denied by Integrity Policy check",
              "5124" : "Undefined Access (no effect) Bit 4",
              "4528" : "Query semaphore state",
              "2055" : "Workstation Trust Account' - Disabled",
              "14640" : "ICMP Echo-Request",
              "4496" : "Control profile",
              "5442" : "WritePreferences",
              "1611" : "Profile System Privilege",
              "4554" : "Undefined Access (no effect) Bit 10",
              "4587" : "Undefined Access (no effect) Bit 11",
              "1810" : "Not granted due to missing",
              "4422" : "DeleteChild",
              "4466" : "Undefined Access (no effect) Bit 2",
              "4358" : "Device Access Bit 6",
              "1882" : "REG_RESOURCE_REQUIREMENTS_LIST",
              "4468" : "Undefined Access (no effect) Bit 4",
              "5380" : "EnumerateDomains",
              "12550" : "IPsec Extended Mode",
              "7942" : "Audit Query Options",
              "16409" : "AES-GMAC 256",
              "4495" : "Undefined Access (no effect) Bit 15",
              "4597" : "AdjustPrivileges",
              "2097" : "Password Expired' - Enabled",
              "5150" : "Undefined Access (no effect) Bit 14",
              "1799" : "Audit Policy query/set API Operation",
              "8064" : "Port sharing (read)",
              "4418" : "AppendData (or AddSubdirectory or CreatePipeInstance)",
              "5635" : "Modify domain trust relationships",
              "4393" : "Undefined Access (no effect) Bit 9",
              "4462" : "Undefined Access (no effect) Bit 14",
              "5693" : "Undefined Access (no effect) Bit 13",
              "14603" : "MAC Native",
              "2439" : "Key failed pair wise consistency check.",
              "2110" : "Undefined UserAccountControl Bit 30' - Enabled",
              "4562" : "Send an alert to thread",
              "1832" : "Identification",
              "4558" : "Undefined Access (no effect) Bit 14",
              "5660" : "Undefined Access (no effect) Bit 12",
              "4537" : "Undefined Access (no effect) Bit 9",
              "5436" : "Undefined Access (no effect) Bit 12",
              "14608" : "Resource Assignment",
              "4864" : "Query State",
              "2459" : "Write persisted key to file.",
              "13573" : "Other Policy Change Events",
              "4366" : "Undefined Access (no effect) Bit 14",
              "8236" : "AES-192",
              "4551" : "Undefined Access (no effect) Bit 7",
              "4588" : "Undefined Access (no effect) Bit 12",
              "7169" : "Create a new service",
              "14642" : "vSwitch Egress",
              "16394" : "SHA-256",
              "1801" : "Granted by",
              "14676" : "Active Directory Domain Services",
              "4485" : "Write to process memory",
              "4449" : "Undefined Access (no effect) Bit 1",
              "4549" : "Undefined Access (no effect) Bit 5",
              "5634" : "Get sensitive policy information",
              "12292" : "Other System Events",
              "2062" : "Not Delegated' - Disabled",
              "16384" : "Add",
              "13317" : "Token Right Adjusted Events",
              "16386" : "Boot-time",
              "1822" : "Blob",
              "4453" : "Undefined Access (no effect) Bit 5",
              "7694" : "Undefined Access (no effect) Bit 14",
              "2067" : "Exclude Authorization Information' - Disabled",
              "4605" : "Undefined Access (no effect) Bit 13",
              "16401" : "AES-192",
              "2102" : "Undefined UserAccountControl Bit 22' - Enabled",
              "1543" : "MAX_ALLOWED",
              "8239" : "Certificate ECDSA P384",
              "5399" : "GetLocalGroupMembership",
              "4428" : "Undefined Access (no effect) Bit 12",
              "7173" : "Set last-known-good state of service database",
              "5662" : "Undefined Access (no effect) Bit 14",
              "14594" : "Forward",
              "8216" : "Enabled",
              "6663" : "Unused Access Flag",
              "1825" : "TRUE",
              "16385" : "Delete",
              "13828" : "Application Group Management",
              "4435" : "Enumerate sub-keys",
              "8206" : "Responder",
              "1920" : "Sunday",
              "5705" : "Undefined Access (no effect) Bit 9",
              "4372" : "Undefined Access (no effect) Bit 4",
              "5454" : "Undefined Access (no effect) Bit 14",
              "8196" : "3DES",
              "2494" : "Remove function.",
              "16900" : "Provider Write",
              "4371" : "Create sub-directory",
              "4492" : "Undefined Access (no effect) Bit 12",
              "4511" : "Undefined Access (no effect) Bit 15",
              "16389" : "Block",
              "4518" : "Undefined Access (no effect) Bit 6",
              "8200" : "Remote computer",
              "1605" : "Increase Memory Quota Privilege",
              "5686" : "Undefined Access (no effect) Bit 6",
              "1802" : "Denied by",
              "1815" : "Granted by parent folder's Central Access Rule",
              "4426" : "Undefined Access (no effect) Bit 10",
              "4481" : "Create new thread in process",
              "4482" : "Set process session ID",
              "6675" : "Hook control",
              "5681" : "Change privileges assigned to account",
              "4364" : "Undefined Access (no effect) Bit 12",
              "16393" : "SHA-1",
              "4367" : "Undefined Access (no effect) Bit 15",
              "4593" : "Duplicate",
              "16387" : "Persistent",
              "1807" : "Denied by Empty DACL",
              "8195" : "DES",
              "1804" : "Granted by Ownership",
              "4510" : "Undefined Access (no effect) Bit 14",
              "4386" : "Undefined Access (no effect) Bit 2",
              "4362" : "Undefined Access (no effect) Bit 10",
              "14641" : "vSwitch Ingress",
              "7427" : "DDE Share Initiate Link",
              "4524" : "Undefined Access (no effect) Bit 12",
              "4447" : "Undefined Access (no effect) Bit 15",
              "8453" : "Success include added",
              "4484" : "Read from process memory",
              "1567" : "Unknown specific access (bit 15)",
              "4497" : "Undefined Access (no effect) Bit 1",
              "1936" : "TokenElevationTypeDefault (1)",
              "4498" : "Undefined Access (no effect) Bit 2",
              "2490" : "Remove provider.",
              "2093" : "Trusted For Delegation' - Enabled",
              "2094" : "Not Delegated' - Enabled",
              "4607" : "Undefined Access (no effect) Bit 15",
              "4361" : "Undefined Access (no effect) Bit 9",
              "4441" : "Enable 64(or 32) bit application to open 32 bit key",
              "7941" : "Audit Set Options",
              "4368" : "Query directory",
              "2485" : "Sign hash.",
              "8225" : "NTLM V2",
              "4355" : "Device Access Bit 3",
              "7186" : "Query status of service",
              "8275" : "Privilege Use",
              "2048" : "Account Enabled",
              "8193" : "Preshared key",
              "2436" : "Random number generator failure.",
              "16396" : "AES-GCM 192",
              "2488" : "Local settings",
              "7683" : "Write Self",
              "4454" : "Undefined Access (no effect) Bit 6",
              "5143" : "Undefined Access (no effect) Bit 7",
              "5437" : "Undefined Access (no effect) Bit 13",
              "4615" : "Undefined Access (no effect) Bit 7",
              "4516" : "Extend size",
              "5697" : "KeyedEvent Wake",
              "14599" : "Stream",
              "8230" : "DH group 1",
              "1925" : "Friday",
              "8457" : "Failure include added",
              "1831" : "...",
              "5657" : "Undefined Access (no effect) Bit 9",
              "5689" : "Undefined Access (no effect) Bit 9",
              "1604" : "Lock Memory Privilege",
              "1849" : "Auto",
              "6674" : "Create menu",
              "2499" : "Machine key.",
              "1560" : "Unknown specific access (bit 8)",
              "4603" : "Undefined Access (no effect) Bit 11",
              "2069" : "Protect Kerberos Service Tickets with AES Keys' - Disabled",
              "16406" : "Initiator",
              "5677" : "Undefined Access (no effect) Bit 13",
              "2068" : "Undefined UserAccountControl Bit 20' - Disabled",
              "2096" : "Don't Require Preauth' - Enabled",
              "1809" : "Unknown or unchecked",
              "5452" : "Undefined Access (no effect) Bit 12",
              "4567" : "Assign a token to the thread",
              "2464" : "Export of persistent cryptographic key.",
              "2090" : "Account Locked",
              "4617" : "Undefined Access (no effect) Bit 9",
              "5405" : "Undefined Access (no effect) Bit 13",
              "1607" : "Trusted Computer Base Privilege",
              "5120" : "Channel read message",
              "5706" : "Undefined Access (no effect) Bit 10",
              "13057" : "Non Sensitive Privilege Use",
              "8199" : "Local computer",
              "1840" : "Delegation",
              "4613" : "Undefined Access (no effect) Bit 5",
              "4523" : "Undefined Access (no effect) Bit 11",
              "7187" : "Enumerate dependencies of service",
              "1921" : "Monday",
              "5694" : "Undefined Access (no effect) Bit 14",
              "5438" : "Undefined Access (no effect) Bit 14",
              "12551" : "Other Logon/Logoff Events",
              "5675" : "Undefined Access (no effect) Bit 11",
              "1537" : "DELETE",
              "1613" : "Profile Single Process Privilege",
              "1617" : "Backup Privilege",
              "4353" : "Device Access Bit 1",
              "6658" : "Access Clipboard",
              "5385" : "Undefined Access (no effect) Bit 9",
              "8215" : "IKE/AuthIP DoS prevention mode stopped",
              "6673" : "Create window",
              "5673" : "Undefined Access (no effect) Bit 9",
              "4442" : "Undefined Access (no effect) Bit 10",
              "4448" : "Query mutant state",
              "5637" : "Create a secret object",
              "8274" : "Object Access",
              "4571" : "Undefined Access (no effect) Bit 11",
              "4564" : "Set thread context",
              "4545" : "Undefined Access (no effect) Bit 1",
              "1812" : "Denied by ACE on parent folder",
              "7691" : "Undefined Access (no effect) Bit 11",
              "7185" : "Set service configuration information",
              "13314" : "DPAPI Activity",
              "2065" : "Password Expired' - Disabled",
              "4356" : "Device Access Bit 4",
              "2313" : "Unknown user name or bad password.",
              "5414" : "Undefined Access (no effect) Bit 6",
              "5700" : "Undefined Access (no effect) Bit 4",
              "4438" : "Undefined Access (no effect) Bit 6",
              "14611" : "Connect",
              "1610" : "Load/Unload Driver Privilege",
              "1814" : "NOT Granted by Central Access Rule",
              "5415" : "Undefined Access (no effect) Bit 7",
              "5680" : "Query account information",
              "2103" : "Undefined UserAccountControl Bit 23' - Enabled",
              "4520" : "Undefined Access (no effect) Bit 8",
              "2481" : "Create Key.",
              "5652" : "Undefined Access (no effect) Bit 4",
              "1620" : "Debug Privilege",
              "14612" : "Flow Established",
              "4559" : "Undefined Access (no effect) Bit 15",
              "5133" : "Undefined Access (no effect) Bit 13",
              "4376" : "Undefined Access (no effect) Bit 8",
              "2493" : "Add function.",
              "14080" : "Directory Service Access",
              "4563" : "Get thread context",
              "14336" : "Credential Validation",
              "5435" : "Undefined Access (no effect) Bit 11",
              "4620" : "Undefined Access (no effect) Bit 12",
              "4553" : "Undefined Access (no effect) Bit 9",
              "2498" : "Remove function property.",
              "1564" : "Unknown specific access (bit 12)",
              "16404" : "Tunnel",
              "4589" : "Undefined Access (no effect) Bit 13",
              "2309" : "The specified account's password has expired.",
              "6678" : "Include this desktop in enumerations",
              "2457" : "Delete key file.",
              "4527" : "Undefined Access (no effect) Bit 15",
              "2050" : "Password Not Required' - Disabled",
              "5396" : "CreateUser",
              "2061" : "Trusted For Delegation' - Disabled",
              "12800" : "File System",
              "8455" : "Success exclude added",
              "2456" : "Open key file.",
              "5386" : "Undefined Access (no effect) Bit 10",
              "6656" : "Enumerate desktops",
              "4578" : "Undefined Access (no effect) Bit 2",
              "16897" : "Execute Method",
              "2500" : "User key.",
              "8214" : "IKE/AuthIP DoS prevention mode started",
              "8202" : "Sent first (SA) payload",
              "5663" : "Undefined Access (no effect) Bit 15",
              "4456" : "Undefined Access (no effect) Bit 8",
              "2064" : "Don't Require Preauth' - Disabled",
              "4552" : "Undefined Access (no effect) Bit 8",
              "8278" : "Account Management",
              "5383" : "Undefined Access (no effect) Bit 7",
              "5381" : "LookupDomain",
              "5711" : "Undefined Access (no effect) Bit 15",
              "7172" : "Query service database lock state",
              "2458" : "Read persisted key from file.",
              "4470" : "Undefined Access (no effect) Bit 6",
              "4444" : "Undefined Access (no effect) Bit 12",
              "5632" : "View non-sensitive policy information",
              "4519" : "Undefined Access (no effect) Bit 7",
              "1830" : "Not granted to AppContainers",
              "5389" : "Undefined Access (no effect) Bit 13",
              "14617" : "Bind Redirect",
              "5412" : "ListMembers",
              "7430" : "DDE Share Poke",
              "4387" : "Undefined Access (no effect) Bit 3",
              "5423" : "Undefined Access (no effect) Bit 15",
              "7189" : "Stop the service",
              "5698" : "Undefined Access (no effect) Bit 2",
              "8205" : "Initiator",
              "2448" : "Failed to unprotect persistent cryptographic key.",
              "1813" : "Granted by Central Access Rule",
              "5398" : "CreateLocalGroup",
              "2063" : "Use DES Key Only' - Disabled",
              "1793" : "<value not set>",
              "2077" : "Undefined UserAccountControl Bit 29' - Disabled",
              "8097" : "Credentials manager",
              "1795" : "Enabled",
              "4566" : "Query thread information",
              "4560" : "Force thread termination",
              "8226" : "CGA",
              "16903" : "Publish",
              "5658" : "Undefined Access (no effect) Bit 10",
              "7695" : "Undefined Access (no effect) Bit 15",
              "1938" : "TokenElevationTypeLimited (3)",
              "5387" : "Undefined Access (no effect) Bit 11",
              "4581" : "Undefined Access (no effect) Bit 5",
              "12812" : "Removable Storage",
              "2105" : "Undefined UserAccountControl Bit 25' - Enabled",
              "2056" : "Server Trust Account' - Disabled",
              "4538" : "Undefined Access (no effect) Bit 10",
              "4475" : "Undefined Access (no effect) Bit 11",
              "4542" : "Undefined Access (no effect) Bit 14",
              "16407" : "AES-GMAC 128",
              "4610" : "Undefined Access (no effect) Bit 2",
              "5707" : "Undefined Access (no effect) Bit 11",
              "7685" : "Write Property",
              "16901" : "Remote Access",
              "4596" : "QuerySource",
              "1623" : "Change Notify (and Traverse) Privilege",
              "4544" : "Use symbolic link",
              "1816" : "NOT Granted by parent folder's Central Access Rule",
              "1877" : "REG_DWORD_BIG_ENDIAN",
              "7686" : "Delete Tree",
              "1818" : "String",
              "8451" : "Failure Added",
              "12290" : "System Integrity",
              "4391" : "Undefined Access (no effect) Bit 7",
              "12549" : "IPsec Quick Mode",
              "5671" : "Undefined Access (no effect) Bit 7",
              "13315" : "RPC Events",
              "4568" : "Cause thread to directly impersonate another thread",
              "4392" : "Undefined Access (no effect) Bit 8",
              "4378" : "Undefined Access (no effect) Bit 10",
              "4514" : "Map section for read",
              "4604" : "Undefined Access (no effect) Bit 12",
              "2070" : "Undefined UserAccountControl Bit 22' - Disabled",
              "2089" : "Don't Expire Password' - Enabled",
              "5131" : "Undefined Access (no effect) Bit 11",
              "4543" : "Undefined Access (no effect) Bit 15",
              "5666" : "Change the controllers in the trusted domain",
              "8208" : "Sent first (SA) payload",
              "8221" : "Sent third (hash) payload",
              "14598" : "Forward",
              "5683" : "Change logon capabilities assigned to account",
              "4499" : "Undefined Access (no effect) Bit 3",
              "4521" : "Undefined Access (no effect) Bit 9",
              "4599" : "AdjustDefaultDacl",
              "8194" : "Unknown authentication",
              "4586" : "Undefined Access (no effect) Bit 10",
              "13313" : "Process Termination",
              "1542" : "ACCESS_SYS_SEC",
              "5433" : "Undefined Access (no effect) Bit 9",
              "7426" : "DDE Share Initiate Static",
              "7431" : "DDE Share Execute",
              "4493" : "Undefined Access (no effect) Bit 13",
              "12813" : "Central Policy Staging",
              "12289" : "Security System Extension",
              "5709" : "Undefined Access (no effect) Bit 13",
              "5377" : "ShutdownServer",
              "1841" : "Denied by Process Trust Label ACE",
              "4478" : "Undefined Access (no effect) Bit 14",
              "5446" : "ChangePassword (with knowledge of old password)",
              "2109" : "Undefined UserAccountControl Bit 29' - Enabled",
              "2100" : "Undefined UserAccountControl Bit 20' - Enabled",
              "16902" : "Subscribe",
              "5122" : "Channel query information",
              "5419" : "Undefined Access (no effect) Bit 11",
              "5391" : "Undefined Access (no effect) Bit 15",
              "1565" : "Unknown specific access (bit 13)",
              "1820" : "64-bit Integer",
              "5403" : "Undefined Access (no effect) Bit 11",
              "16400" : "AES-128",
              "5665" : "Retrieve the controllers in the trusted domain",
              "5643" : "Lookup Names/SIDs",
              "4609" : "Undefined Access (no effect) Bit 1",
              "6677" : "Journal (playback)",
              "5378" : "InitializeServer",
              "5633" : "View system audit requirements",
              "4425" : "Undefined Access (no effect) Bit 9",
              "12291" : "IPsec Driver",
              "4479" : "Undefined Access (no effect) Bit 15",
              "4359" : "Device Access Bit 7",
              "5417" : "Undefined Access (no effect) Bit 9",
              "5684" : "Change the Posix ID offset assigned to the accounted domain",
              "4424" : "WriteAttributes",
              "5434" : "Undefined Access (no effect) Bit 10",
              "6931" : "Print",
              "4594" : "Impersonate",
              "5132" : "Undefined Access (no effect) Bit 12",
              "1540" : "WRITE_OWNER",
              "13568" : "Audit Policy Change",
              "4612" : "Undefined Access (no effect) Bit 4",
              "2312" : "User not allowed to logon at this computer.",
              "4541" : "Undefined Access (no effect) Bit 13",
              "4600" : "AdjustSessionID",
              "8207" : "No state",
              "4546" : "Undefined Access (no effect) Bit 2",
              "4397" : "Undefined Access (no effect) Bit 13",
              "8450" : "Failure removed",
              "4572" : "Undefined Access (no effect) Bit 12",
              "4455" : "Undefined Access (no effect) Bit 7",
              "5653" : "Undefined Access (no effect) Bit 5",
              "5667" : "Query the Posix ID offset assigned to the trusted domain",
              "2049" : "Home Directory Required' - Disabled",
              "13829" : "Other Account Management Events",
              "2108" : "Undefined UserAccountControl Bit 28' - Enabled",
              "5704" : "Undefined Access (no effect) Bit 8",
              "1808" : "Granted by NULL Security Descriptor",
              "1618" : "Restore From Backup Privilege",
              "4569" : "Directly impersonate this thread",
              "1926" : "Saturday",
              "1622" : "Change Hardware Environment Privilege",
              "5138" : "Query Attributes",
              "2111" : "Undefined UserAccountControl Bit 31' - Enabled",
              "2099" : "Exclude Authorization Information' - Enabled",
              "8279" : "DS Access",
              "14614" : "Resource Release",
              "5411" : "RemoveMember",
              "4533" : "Undefined Access (no effect) Bit 5",
              "5395" : "WriteOtherParameters",
              "5451" : "Undefined Access (no effect) Bit 11",
              "5664" : "Query trusted domain name/SID",
              "4480" : "Force process termination",
              "4395" : "Undefined Access (no effect) Bit 11",
              "4508" : "Undefined Access (no effect) Bit 12",
              "5394" : "ReadOtherParameters",
              "16391" : "Callout",
              "4591" : "Undefined Access (no effect) Bit 15",
              "1821" : "FQBN",
              "1827" : "Invalid",
              "14674" : "Value Added",
              "1566" : "Unknown specific access (bit 14)",
              "1883" : "REG_QWORD",
              "16405" : "Responder",
              "5703" : "Undefined Access (no effect) Bit 7",
              "1614" : "Increment Base Priority Privilege",
              "14677" : "Active Directory Lightweight Directory Services",
              "7681" : "Delete Child",
              "12552" : "Network Policy Server",
              "16392" : "MD5",
              "4540" : "Undefined Access (no effect) Bit 12",
              "6930" : "Full Control",
              "2088" : "Server Trust Account' - Enabled",
              "2058" : "Account Unlocked",
              "5148" : "Undefined Access (no effect) Bit 12",
              "1817" : "Unknown Type",
              "4440" : "Enable 64(or 32) bit application to open 64 bit key",
              "1826" : "FALSE",
              "2483" : "Encrypt.",
              "8449" : "Success Added",
              "4502" : "Undefined Access (no effect) Bit 6",
              "2315" : "Smartcard logon is required and was not used.",
              "12802" : "Kernel Object",
              "4517" : "Undefined Access (no effect) Bit 5",
              "8227" : "Certificate",
              "8247" : "EAP",
              "8098" : "Fresh credentials",
              "5638" : "Create a privilege",
              "14596" : "IP Packet",
              "4489" : "Set process information",
              "2086" : "Interdomain Trust Account' - Enabled",
              "4611" : "Undefined Access (no effect) Bit 3",
              "4487" : "Create a subprocess of process",
              "5655" : "Undefined Access (no effect) Bit 7",
              "5397" : "CreateGlobalGroup",
              "5376" : "ConnectToServer",
              "4416" : "ReadData (or ListDirectory)",
              "1619" : "Shutdown System Privilege",
              "5151" : "Undefined Access (no effect) Bit 15",
              "2314" : "Domain sid inconsistent.",
              "8245" : "EAP payload sent",
              "6912" : "Administer print server",
              "1557" : "Unknown specific access (bit 5)",
              "1844" : "System",
              "8228" : "SSL",
              "5701" : "Undefined Access (no effect) Bit 5",
              "14615" : "Endpoint Closure",
              "6913" : "Enumerate printers",
              "5422" : "Undefined Access (no effect) Bit 14",
              "5429" : "Undefined Access (no effect) Bit 5",
              "1847" : "DisallowMmConfig",
              "2092" : "Smartcard Required' - Enabled",
              "1601" : "Not used",
              "6664" : "Include this windowstation in enumerations",
              "7939" : "Audit Query Per User Policy",
              "8224" : "Anonymous",
              "8448" : "Success removed",
              "8232" : "DH group 14",
              "2052" : "Normal Account' - Disabled",
              "8192" : "Kerberos",
              "6657" : "Read attributes",
              "1541" : "SYNCHRONIZE",
              "2306" : "The NetLogon component is not active.",
              "4467" : "Undefined Access (no effect) Bit 3",
              "6679" : "Write objects",
              "4396" : "Undefined Access (no effect) Bit 12",
              "5650" : "Undefined Access (no effect) Bit 2",
              "7690" : "Undefined Access (no effect) Bit 10",
              "4592" : "AssignAsPrimary",
              "6662" : "Exit windows",
              "4585" : "Undefined Access (no effect) Bit 9",
              "16416" : "AuthNoEncap Transport",
              "12804" : "Other Object Access Events",
              "2305" : "The specified user account has expired.",
              "4461" : "Undefined Access (no effect) Bit 13",
              "1603" : "Assign Primary Token Privilege",
              "14592" : "Inbound",
              "1843" : "No",
              "5425" : "RemoveMember",
              "4469" : "Undefined Access (no effect) Bit 5",
              "2095" : "Use DES Key Only' - Enabled",
              "13826" : "Security Group Management",
              "4430" : "Undefined Access (no effect) Bit 14",
              "1558" : "Unknown specific access (bit 6)",
              "2311" : "Account logon time restriction violation.",
              "8277" : "Policy Change",
              "7171" : "Lock service database for exclusive access",
              "5421" : "Undefined Access (no effect) Bit 13",
              "4374" : "Undefined Access (no effect) Bit 6",
              "1561" : "Unknown specific access (bit 9)",
              "4622" : "Undefined Access (no effect) Bit 14",
              "8223" : "AuthIP",
              "4621" : "Undefined Access (no effect) Bit 13",
              "1794" : "<never>",
              "8454" : "Success exclude removed",
              "8244" : "IKEv2",
              "4529" : "Modify semaphore state",
              "4365" : "Undefined Access (no effect) Bit 13",
              "13058" : "Other Privilege Use Events",
              "2308" : "The user has not been granted the requested logon type at this machine.",
              "6680" : "Switch to this desktop",
              "5136" : "Assign process",
              "7692" : "Undefined Access (no effect) Bit 12",
              "5447" : "SetPassword (without knowledge of old password)",
              "4522" : "Undefined Access (no effect) Bit 10",
              "4490" : "Query process information",
              "5710" : "Undefined Access (no effect) Bit 14",
              "4459" : "Undefined Access (no effect) Bit 11",
              "5444" : "ReadAccount",
              "4577" : "Modify timer state",
              "8238" : "Certificate ECDSA P256",
              "5135" : "Undefined Access (no effect) Bit 15",
              "8197" : "MD5",
              "4385" : "Modify event state",
              "2491" : "Add context.",
              "4601" : "Undefined Access (no effect) Bit 9",
              "1880" : "REG_RESOURCE_LIST",
              "6672" : "Read Objects",
              "2074" : "Undefined UserAccountControl Bit 26' - Disabled",
              "5401" : "LookupIDs",
              "4429" : "Undefined Access (no effect) Bit 13",
              "2101" : "Protect Kerberos Service Tickets with AES Keys' - Enabled",
              "2059" : "Encrypted Text Password Allowed' - Disabled",
              "5455" : "Undefined Access (no effect) Bit 15",
              "4363" : "Undefined Access (no effect) Bit 11",
              "13824" : "User Account Management",
              "8229" : "None",
              "5688" : "Undefined Access (no effect) Bit 8",
              "7168" : "Connect to service controller",
              "2084" : "Normal Account' - Enabled",
              "7429" : "DDE Share Advise",
              "4494" : "Undefined Access (no effect) Bit 14",
              "7687" : "List Object",
              "6660" : "Write attributes",
              "5410" : "AddMember",
              "5127" : "Undefined Access (no effect) Bit 7",
              "4535" : "Undefined Access (no effect) Bit 7",
              "4394" : "Undefined Access (no effect) Bit 10",
              "4532" : "Undefined Access (no effect) Bit 4",
              "14082" : "Directory Service Replication",
              "8218" : "No state",
              "13316" : "Plug and Play Events",
              "16390" : "Permit",
              "7937" : "Audit Query System Policy",
              "4614" : "Undefined Access (no effect) Bit 6",
              "8459" : "Failure exclude added",
              "5413" : "Undefined Access (no effect) Bit 5",
              "2106" : "Undefined UserAccountControl Bit 26' - Enabled",
              "2450" : "Validation of public key failed.",
              "5144" : "Undefined Access (no effect) Bit 8",
              "8219" : "Sent first (EM attributes) payload",
              "12547" : "IPsec Main Mode",
              "5639" : "Set default quota limits",
              "4531" : "Undefined Access (no effect) Bit 3",
              "8456" : "Failure include removed",
              "5142" : "Undefined Access (no effect) Bit 6",
              "4513" : "Map section for write",
              "4476" : "Undefined Access (no effect) Bit 12",
              "1553" : "Unknown specific access (bit 1)",
              "7424" : "DDE Share Read",
              "5121" : "Channel write message",
              "14604" : "vSwitch",
              "5443" : "ReadLogon",
              "14673" : "[NULL]",
              "4434" : "Create sub-key",
              "1923" : "Wednesday",
              "4584" : "Undefined Access (no effect) Bit 8",
              "5402" : "AdministerServer",
              "7428" : "DDE Share Request",
              "4547" : "Undefined Access (no effect) Bit 3",
              "1878" : "REG_LINK",
              "5649" : "Query secret value",
              "1606" : "Unsolicited Input Privilege",
              "12803" : "SAM",
              "14610" : "Receive/Accept",
              "8242" : "SHA 256",
              "1811" : "Granted by ACE on parent folder",
              "5140" : "Set Security Attributes",
              "4436" : "Notify about changes to keys",
              "5682" : "Change quotas assigned to account",
              "1806" : "Granted by NULL DACL",
              "14597" : "Transport",
              "5431" : "Undefined Access (no effect) Bit 7",
              "1554" : "Unknown specific access (bit 2)",
              "4427" : "Undefined Access (no effect) Bit 11",
              "4354" : "Device Access Bit 2",
              "5388" : "Undefined Access (no effect) Bit 12",
              "279" : "Undefined Access (no effect) Bit 7",
              "4431" : "Undefined Access (no effect) Bit 15",
              "4439" : "Undefined Access (no effect) Bit 7",
              "4595" : "Query",
              "1608" : "Security Privilege",
              "4352" : "Device Access Bit 0",
              "7682" : "List Contents",
              "1797" : "All",
              "8203" : "Sent second (KE) payload",
              "5409" : "WriteAccount",
              "2497" : "Add function property.",
              "7688" : "Control Access",
              "8243" : "SHA 384",
              "12809" : "Filtering Platform Packet Drop",
              "5448" : "ListGroups",
              "5129" : "Undefined Access (no effect) Bit 9",
              "2066" : "Trusted To Authenticate For Delegation' - Disabled",
              "2075" : "Undefined UserAccountControl Bit 27' - Disabled",
              "2073" : "Undefined UserAccountControl Bit 25' - Disabled",
              "13825" : "Computer Account Management",
              "16408" : "AES-GMAC 192",
              "5440" : "ReadGeneralInformation",
              "7936" : "Audit Set System Policy",
              "8458" : "Failure exclude removed",
              "4503" : "Undefined Access (no effect) Bit 7",
              "1904" : "New registry value created",
              "1833" : "Impersonation",
              "7938" : "Audit Set Per User Policy",
              "7433" : "DDE Share List Items",
              "14337" : "Kerberos Service Ticket Operations",
              "2432" : "Not Available.",
              "4618" : "Undefined Access (no effect) Bit 10",
              "4398" : "Undefined Access (no effect) Bit 14",
              "5676" : "Undefined Access (no effect) Bit 12",
              "2104" : "Undefined UserAccountControl Bit 24' - Enabled",
              "5661" : "Undefined Access (no effect) Bit 13",
              "8201" : "No state",
              "5678" : "Undefined Access (no effect) Bit 14",
              "5406" : "Undefined Access (no effect) Bit 14",
              "8212" : "Transport",
              "4556" : "Undefined Access (no effect) Bit 12",
              "12805" : "Certification Services",
              "4419" : "ReadEA",
              "1559" : "Unknown specific access (bit 7)",
              "4580" : "Undefined Access (no effect) Bit 4",
              "4590" : "Undefined Access (no effect) Bit 14",
              "4437" : "Create Link",
              "2310" : "Account currently disabled.",
              "5696" : "KeyedEvent Wait",
              "1875" : "REG_BINARY",
              "2081" : "Home Directory Required' - Enabled"
            },
            "AccessMaskDescriptions" : {
              "0x00040000" : "WRITE_DAC",
              "0x00080000" : "WRITE_OWNER",
              "0x00000002" : "Delete Child",
              "0x00000020" : "Write Property",
              "0x40000000" : "ADS_RIGHT_GENERIC_WRITE",
              "0x80000000" : "ADS_RIGHT_GENERIC_READ",
              "0x00020000" : "READ_CONTROL",
              "0x00010000" : "DELETE",
              "0x0000FFFF" : "SPECIFIC_RIGHTS_ALL",
              "0x00100000" : "SYNCHRONIZE",
              "0x00000100" : "Control Access",
              "0x00F00000" : "STANDARD_RIGHTS_REQUIRED",
              "0x00000008" : "SELF",
              "0x00000040" : "Delete Treee",
              "0x00000004" : "List Contents",
              "0x001F0000" : "STANDARD_RIGHTS_ALL",
              "0x01000000" : "ADS_RIGHT_ACCESS_SYSTEM_SECURITY",
              "0x10000000" : "ADS_RIGHT_GENERIC_ALL",
              "0x00000001" : "Create Child",
              "0x00000010" : "Read Property",
              "0x00000080" : "List Object",
              "0x20000000" : "ADS_RIGHT_GENERIC_EXECUTE"
            }
          }
        }
      },
      {
        "script" : {
          "description" : "4625 and 4776 Set Status and SubStatus",
          "params" : {
            "0xc000006a" : "User logon with misspelled or bad password",
            "0xc00000dc" : "Indicates the Sam Server was in the wrong state to perform the desired operation.",
            "0xc0000192" : "An attempt was made to logon, but the Netlogon service was not started.",
            "0xc000005e" : "There are currently no logon servers available to service the logon request.",
            "0xc0000224" : "User is required to change password at next logon",
            "0xc00002ee" : "Failure Reason: An Error occurred during Logon",
            "0xc000006e" : "Unknown user name or bad password.",
            "0xc0000071" : "User logon with expired password",
            "0xc0000070" : "User logon from unauthorized workstation",
            "0xc0000133" : "Clocks between DC and other computer too far out of sync",
            "0xc0000413" : "Logon Failure: The machine you are logging onto is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine.",
            "0x0" : "Status OK.",
            "0xc0000193" : "User logon with expired account",
            "0xc000018c" : "The logon request failed because the trust relationship between the primary domain and the trusted domain failed.",
            "0xc0000225" : "Evidently a bug in Windows and not a risk",
            "0xc0000371" : "The local account store does not contain secret material for the specified account",
            "0xc000015b" : "The user has not been granted the requested logon type (aka logon right) at this machine",
            "0xc0000064" : "User logon with misspelled or bad user account",
            "0xc000006d" : "This is either due to a bad username or authentication information",
            "0xc0000072" : "User logon to account disabled by administrator",
            "0xc000006f" : "User logon outside authorized hours",
            "0xc0000234" : "User logon with account locked"
          },
          "source" : "if (ctx?.winlog?.event_data?.Status == null ||\n    ctx?.event?.code == null ||\n    ![\"4625\", \"4776\"].contains(ctx.event.code)) {\n  return;\n}\nif (params.containsKey(ctx.winlog.event_data.Status)) {\n  if (ctx?.winlog?.logon == null ) {\n      HashMap hm = new HashMap();\n      ctx.winlog.put(\"logon\", hm);\n  }\n  if (ctx?.winlog?.logon?.failure == null) {\n      HashMap hm = new HashMap();\n      ctx.winlog.logon.put(\"failure\", hm);\n  }\n  ctx.winlog.logon.failure.put(\"status\", params[ctx.winlog.event_data.Status]);\n}\nif (ctx?.winlog?.event_data?.SubStatus == null || !params.containsKey(ctx.winlog.event_data.SubStatus)) {\n  return;\n}\nif (ctx?.winlog?.logon == null ) {\n  HashMap hm = new HashMap();\n  ctx.winlog.put(\"logon\", hm);\n}\nif (ctx?.winlog?.logon?.failure == null) {\n  HashMap hm = new HashMap();\n  ctx.winlog.logon.put(\"failure\", hm);\n}\nctx.winlog.logon.failure.put(\"sub_status\", params[ctx.winlog.event_data.SubStatus]);",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "4625 and 4776 Set Status and SubStatus"
        }
      },
      {
        "script" : {
          "ignore_failure" : false,
          "tag" : "Set Trust Type",
          "description" : "Set Trust Type",
          "params" : {
            "3" : "TRUST_TYPE_MIT",
            "4" : "TRUST_TYPE_DCE",
            "1" : "TRUST_TYPE_DOWNLEVEL",
            "2" : "TRUST_TYPE_UPLEVEL"
          },
          "source" : "if (ctx?.winlog?.event_data?.TdoType == null) {\n  return;\n}\nif (!params.containsKey(ctx.winlog.event_data.TdoType)) {\n  return;\n}\nctx.winlog.put(\"trustType\", params[ctx.winlog.event_data.TdoType]);",
          "lang" : "painless"
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Set Trust Direction",
          "description" : "Set Trust Direction",
          "params" : {
            "3" : "TRUST_DIRECTION_BIDIRECTIONAL",
            "0" : "TRUST_DIRECTION_DISABLED",
            "1" : "TRUST_DIRECTION_INBOUND",
            "2" : "TRUST_DIRECTION_OUTBOUND"
          },
          "source" : "if (ctx?.winlog?.event_data?.TdoDirection == null) {\n  return;\n}\nif (!params.containsKey(ctx.winlog.event_data.TdoDirection)) {\n  return;\n}\nctx.winlog.put(\"trustDirection\", params[ctx.winlog.event_data.TdoDirection]);"
        }
      },
      {
        "script" : {
          "tag" : "Set Trust Attributes",
          "description" : "Set Trust Attributes",
          "params" : {
            "8" : "TRUST_ATTRIBUTE_FOREST_TRANSITIVE",
            "128" : "TRUST_ATTRIBUTE_USES_RC4_ENCRYPTION",
            "512" : "TRUST_ATTRIBUTE_CROSS_ORGANIZATION_NO_TGT_DELEGATION",
            "0" : "UNDEFINED",
            "2" : "TRUST_ATTRIBUTE_UPLEVEL_ONLY",
            "4" : "TRUST_ATTRIBUTE_QUARANTINED_DOMAIN",
            "16" : "TRUST_ATTRIBUTE_CROSS_ORGANIZATION",
            "32" : "TRUST_ATTRIBUTE_WITHIN_FOREST",
            "64" : "TRUST_ATTRIBUTE_TREAT_AS_EXTERNAL",
            "1024" : "TRUST_ATTRIBUTE_PIM_TRUST",
            "1" : "TRUST_ATTRIBUTE_NON_TRANSITIVE"
          },
          "source" : "if (ctx?.winlog?.event_data?.TdoAttributes == null) {\n  return;\n}\nif (!params.containsKey(ctx.winlog.event_data.TdoAttributes)) {\n  return;\n}\nctx.winlog.put(\"trustAttribute\", params[ctx.winlog.event_data.TdoAttributes]);",
          "lang" : "painless",
          "ignore_failure" : false
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Add Session Events",
          "description" : "Add Session Events",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4778\", \"4779\"].contains(ctx.event.code)) {\n  return;\n}\n//AccountName to user.name and related.user\nif (ctx?.winlog?.event_data?.AccountName != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  ctx.user.put(\"name\", ctx.winlog.event_data.AccountName);\n  if (!ctx.related.user.contains(ctx.winlog.event_data.AccountName)) {\n    ctx.related.user.add(ctx.winlog.event_data.AccountName);\n  }\n}\n\n//AccountDomain to user.domain\nif (ctx?.winlog?.event_data?.AccountDomain != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  ctx.user.put(\"domain\", ctx.winlog.event_data.AccountDomain);\n}\n\n//ClientAddress to source.ip and related.ip\nif (ctx?.winlog?.event_data?.ClientAddress != null &&\n    ctx.winlog.event_data.ClientAddress != \"-\" &&\n    ctx.winlog.event_data.ClientAddress != \"Unknown\") {\n  // Correct invalid IP address \"LOCAL\"\n  if (ctx?.winlog?.event_data?.ClientAddress == \"LOCAL\") {\n    ctx.winlog.event_data.ClientAddress=\"127.0.0.1\";\n  }\n  if (ctx?.source == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"source\", hm);\n  }\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  if (ctx?.related?.ip == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"ip\", al);\n  }\n  ctx.source.put(\"ip\", ctx.winlog.event_data.ClientAddress);\n  if (!ctx.related.ip.contains(ctx.winlog.event_data.ClientAddress)) {\n    ctx.related.ip.add(ctx.winlog.event_data.ClientAddress);\n  }\n}\n\n//ClientName to source.domain\nif (ctx?.winlog?.event_data?.ClientName != null) {\n  if (ctx?.source == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"source\", hm);\n  }\n  ctx.source.put(\"domain\", ctx.winlog.event_data.ClientName);\n}\n\n//LogonID to winlog.logon.id\nif (ctx?.winlog?.event_data?.LogonID != null) {\n  if (ctx?.winlog?.logon == null) {\n    HashMap hm = new HashMap();\n    ctx.winlog.put(\"logon\", hm);\n  }\n  ctx.winlog.logon.put(\"id\", ctx.winlog.event_data.LogonID);\n}"
        }
      },
      {
        "script" : {
          "description" : "Copy Target User",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4624\", \"4625\", \"4634\", \"4647\", \"4648\", \"4768\", \"4769\", \"4770\",\n      \"4771\", \"4776\", \"4964\"].contains(ctx.event.code)) {\n  return;\n}\n\ndef targetUserId = ctx?.winlog?.event_data?.TargetUserSid;\nif (targetUserId == null) {\n  targetUserId = ctx?.winlog?.event_data?.TargetSid;\n}\n\n//TargetUserSid to user.id or user.target.id\nif (targetUserId != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  if (ctx?.user?.id == null) {\n    ctx.user.put(\"id\", targetUserId);\n  } else {\n    if (ctx?.user?.target == null) {\n      HashMap hm = new HashMap();\n      ctx.user.put(\"target\", hm);\n    }\n    ctx.user.target.put(\"id\", targetUserId);\n  }\n}\n\n//TargetUserName to related.user and user.name or user.target.name\nif (ctx?.winlog?.event_data?.TargetUserName != null) {\n  def tun = ctx.winlog.event_data.TargetUserName.splitOnToken(\"@\");\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  if (ctx?.user?.name == null) {\n    ctx.user.put(\"name\", tun[0]);\n  } else {\n    if (ctx?.user?.target == null) {\n      HashMap hm = new HashMap();\n      ctx.user.put(\"target\", hm);\n    }\n    ctx.user.target.put(\"name\", tun[0]);\n  }\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  if (!ctx.related.user.contains(tun[0])) {\n    ctx.related.user.add(tun[0]);\n  }\n}\n//TargetUserDomain to user.domain or user.target.domain\nif (ctx?.winlog?.event_data?.TargetDomainName != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  if (ctx?.user?.domain == null) {\n    ctx.user.put(\"domain\", ctx.winlog.event_data.TargetDomainName);\n  } else {\n    if (ctx?.user?.target == null){\n      HashMap hm = new HashMap();\n      ctx.user.put(\"target\", hm);\n    }\n    ctx.user.target.put(\"domain\", ctx.winlog.event_data.TargetDomainName);\n  }\n}",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Copy Target User"
        }
      },
      {
        "script" : {
          "description" : "Copy MemberName to User and User to Group",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4727\", \"4728\", \"4729\", \"4730\", \"4731\", \"4732\", \"4733\", \"4734\", \"4735\",\n      \"4737\", \"4744\", \"4745\", \"4746\", \"4747\", \"4748\", \"4749\", \"4750\", \"4751\",\n      \"4752\", \"4753\", \"4754\", \"4755\", \"4756\", \"4757\", \"4758\", \"4759\", \"4760\",\n      \"4761\", \"4762\", \"4763\", \"4764\", \"4799\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.winlog?.event_data?.MemberName != null) {\n  def memberNameParts = ctx.winlog.event_data.MemberName.splitOnToken(\",\");\n  def memberName = memberNameParts[0].replace(\"CN=\",\"\").replace(\"cn=\",\"\");\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  if (ctx?.user?.target == null){\n    HashMap hm = new HashMap();\n    ctx.user.put(\"target\", hm);\n  }\n  ctx.user.target.put(\"name\", memberName);\n  if (!ctx.related.user.contains(memberName)) {\n    ctx.related.user.add(memberName);\n  }\n  if (memberNameParts.length >= 4) {\n    def domain = memberNameParts[3].replace(\"DC=\", \"\").replace(\"dc=\", \"\");\n    ctx.user.target.put(\"domain\", domain);\n  }\n}\nif (ctx?.winlog?.event_data?.TargetUserSid != null) {\n  if (ctx?.group == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"group\", hm);\n  }\n  ctx.group.put(\"id\", ctx.winlog.event_data.TargetUserSid);\n}\nif (ctx?.winlog?.event_data?.TargetSid != null) {\n  if (ctx?.group == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"group\", hm);\n  }\n  ctx.group.put(\"id\", ctx.winlog.event_data.TargetSid);\n}\nif (ctx?.winlog?.event_data?.TargetUserName != null) {\n  if (ctx?.group == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"group\", hm);\n  }\n  ctx.group.put(\"name\", ctx.winlog.event_data.TargetUserName);\n}\nif (ctx?.winlog?.event_data?.TargetDomainName != null) {\n  if (ctx?.group == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"group\", hm);\n  }\n  def domain = ctx.winlog.event_data.TargetDomainName.replace(\"DC=\", \"\").replace(\"dc=\", \"\");\n  ctx.group.put(\"domain\", domain);\n}\nif (ctx?.user?.target != null) {\n  if (ctx?.user?.target?.group == null) {\n    HashMap hm = new HashMap();\n    ctx.user.target.put(\"group\", hm);\n  }\n  if (ctx?.group?.id != null) {\n    ctx.user.target.group.put(\"id\", ctx.group.id);\n  }\n  if (ctx?.group?.name != null) {\n    ctx.user.target.group.put(\"name\", ctx.group.name);\n  }\n  if (ctx?.group?.domain != null) {\n    ctx.user.target.group.put(\"domain\", ctx.group.domain);\n  }\n}",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Copy MemberName to User and User to Group"
        }
      },
      {
        "script" : {
          "tag" : "Copy Target User to Computer Object",
          "description" : "Copy Target User to Computer Object",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4741\", \"4742\", \"4743\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.winlog?.event_data?.TargetSid != null) {\n  if (ctx?.winlog?.computerObject == null) {\n    HashMap hm = new HashMap();\n    ctx.winlog.put(\"computerObject\", hm);\n  }\n  ctx.winlog.computerObject.put(\"id\", ctx.winlog.event_data.TargetSid);\n}\nif (ctx?.winlog?.event_data?.TargetUserName != null) {\n  if (ctx?.winlog?.computerObject == null) {\n    HashMap hm = new HashMap();\n    ctx.winlog.put(\"computerObject\", hm);\n  }\n  ctx.winlog.computerObject.put(\"name\", ctx.winlog.event_data.TargetUserName);\n}\nif (ctx?.winlog?.event_data?.TargetDomainName != null) {\n  if (ctx?.winlog?.computerObject == null) {\n    HashMap hm = new HashMap();\n    ctx.winlog.put(\"computerObject\", hm);\n  }\n  ctx.winlog.computerObject.put(\"domain\", ctx.winlog.event_data.TargetDomainName);\n}",
          "lang" : "painless",
          "ignore_failure" : false
        }
      },
      {
        "set" : {
          "ignore_failure" : false,
          "if" : "ctx?.event?.code != null && [\"4634\", \"4647\", \"4964\"].contains(ctx.event.code)",
          "field" : "winlog.logon.id",
          "copy_from" : "winlog.event_data.TargetLogonId"
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Copy Subject User from Event Data",
          "description" : "Copy Subject User from Event Data",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4657\", \"4670\", \"4672\", \"4673\", \"4674\", \"4688\", \"4689\", \"4697\",\n      \"4698\", \"4699\", \"4700\", \"4701\", \"4702\", \"4706\", \"4707\", \"4713\",\n      \"4716\", \"4717\", \"4718\", \"4719\", \"4720\", \"4722\", \"4723\", \"4724\",\n      \"4725\", \"4726\", \"4727\", \"4728\", \"4729\", \"4730\", \"4731\", \"4732\",\n      \"4733\", \"4734\", \"4735\", \"4737\", \"4738\", \"4739\", \"4740\", \"4741\",\n      \"4742\", \"4743\", \"4744\", \"4745\", \"4746\", \"4747\", \"4748\", \"4749\",\n      \"4750\", \"4751\", \"4752\", \"4753\", \"4754\", \"4755\", \"4756\", \"4757\",\n      \"4758\", \"4759\", \"4760\", \"4761\", \"4762\", \"4763\", \"4764\", \"4767\",\n      \"4781\", \"4798\", \"4799\", \"4817\", \"4904\", \"4905\", \"4907\", \"4912\",\n      \"4648\", \"4797\", \"5140\", \"5145\", \"5379\", \"5380\", \"5381\", \"5382\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.winlog?.event_data?.SubjectUserSid != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  ctx.user.put(\"id\", ctx.winlog.event_data.SubjectUserSid);\n}\nif (ctx?.winlog?.event_data?.SubjectUserName != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  ctx.user.put(\"name\", ctx.winlog.event_data.SubjectUserName);\n  if (!ctx.related.user.contains(ctx.winlog.event_data.SubjectUserName)) {\n    ctx.related.user.add(ctx.winlog.event_data.SubjectUserName);\n  }\n}\nif (ctx?.winlog?.event_data?.SubjectDomainName != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  ctx.user.put(\"domain\", ctx.winlog.event_data.SubjectDomainName);\n}"
        }
      },
      {
        "script" : {
          "ignore_failure" : false,
          "tag" : "Copy Target User to Target",
          "description" : "Copy Target User to Target",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4670\", \"4720\", \"4722\", \"4723\", \"4724\", \"4725\",\n      \"4726\", \"4738\", \"4740\", \"4767\", \"4798\", \"4817\",\n      \"4907\", \"4797\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n}\nif (ctx?.user?.target == null) {\n    HashMap hm = new HashMap();\n    ctx.user.put(\"target\", hm);\n}\ndef userId = ctx?.winlog?.event_data?.TargetSid;\nif (userId != null && userId != \"\" && userId != \"-\") ctx.user.target.id = userId;\ndef userName = ctx?.winlog?.event_data?.TargetUserName;\nif (userName != null && userName != \"\" && userName != \"-\") {\n  ctx.user.target.name = userName;\n  def parts = userName.splitOnToken(\"@\");\n  if (parts.length > 1) {\n    ctx.user.target.name = parts[0];\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  if (!ctx.related.user.contains(ctx.user.target.name)) {\n    ctx.related.user.add(ctx.user.target.name);\n  }\n}\ndef userDomain = ctx?.winlog?.event_data?.TargetDomainName;\nif (userDomain != null && userDomain != \"\" && userDomain != \"-\") ctx.user.target.domain = userDomain;\nif (ctx.user?.target != null && ctx.user.target.size() == 0) ctx.user.remove(\"target\");",
          "lang" : "painless"
        }
      },
      {
        "script" : {
          "ignore_failure" : false,
          "tag" : "Copy Target User to Effective",
          "description" : "Copy Target User to Effective",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4648\", \"4688\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n}\nif (ctx?.user?.effective == null) {\n    HashMap hm = new HashMap();\n    ctx.user.put(\"effective\", hm);\n}\ndef userId = ctx?.winlog?.event_data?.TargetUserSid;\nif (userId != null && userId != \"\" && userId != \"-\") ctx.user.effective.id = userId;\ndef userName = ctx?.winlog?.event_data?.TargetUserName;\nif (userName != null && userName != \"\" && userName != \"-\") {\n  ctx.user.effective.name = userName;\n  def parts = userName.splitOnToken(\"@\");\n  if (parts.length > 1) {\n    ctx.user.effective.name = parts[0];\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  if (!ctx.related.user.contains(ctx.user.effective.name)) {\n    ctx.related.user.add(ctx.user.effective.name);\n  }\n}\ndef userDomain = ctx?.winlog?.event_data?.TargetDomainName;\nif (userDomain != null && userDomain != \"\" && userDomain != \"-\") ctx.user.effective.domain = userDomain;\nif (ctx.user?.effective != null && ctx.user.effective.size() == 0) ctx.user.remove(\"effective\");",
          "lang" : "painless"
        }
      },
      {
        "script" : {
          "source" : "if (ctx?.event?.code == null ||\n    ![\"1102\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.winlog?.user_data?.SubjectUserSid != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  ctx.user.put(\"id\", ctx.winlog.user_data.SubjectUserSid);\n}\nif (ctx?.winlog?.user_data?.SubjectUserName != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  ctx.user.put(\"name\", ctx.winlog.user_data.SubjectUserName);\n  if (!ctx.related.user.contains(ctx.winlog.user_data.SubjectUserName)) {\n    ctx.related.user.add(ctx.winlog.user_data.SubjectUserName);\n  }\n}\nif (ctx?.winlog?.user_data?.SubjectDomainName != null) {\n  if (ctx?.user == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"user\", hm);\n  }\n  ctx.user.put(\"domain\", ctx.winlog.user_data.SubjectDomainName);\n}",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Copy Subject User from user_data",
          "description" : "Copy Subject User from user_data"
        }
      },
      {
        "set" : {
          "field" : "winlog.logon.id",
          "copy_from" : "winlog.event_data.SubjectLogonId",
          "ignore_failure" : true
        }
      },
      {
        "set" : {
          "field" : "winlog.logon.id",
          "copy_from" : "winlog.user_data.SubjectLogonId",
          "ignore_failure" : true,
          "if" : "ctx?.event?.code != null &&\n[\"1102\"].contains(ctx.event.code)"
        }
      },
      {
        "script" : {
          "description" : "Rename Common Auth Fields",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"1100\", \"1102\", \"1104\", \"1105\", \"1108\", \"4624\", \"4648\", \"4625\",\n      \"4670\", \"4673\", \"4674\", \"4689\", \"4697\", \"4719\", \"4720\", \"4722\",\n      \"4723\", \"4724\", \"4725\", \"4726\", \"4727\", \"4728\", \"4729\", \"4730\",\n      \"4731\", \"4732\", \"4733\", \"4734\", \"4735\", \"4737\", \"4738\", \"4740\",\n      \"4741\", \"4742\", \"4743\", \"4744\", \"4745\", \"4746\", \"4747\", \"4748\",\n      \"4749\", \"4750\", \"4751\", \"4752\", \"4753\", \"4754\", \"4755\", \"4756\",\n      \"4757\", \"4758\", \"4759\", \"4760\", \"4761\", \"4762\", \"4763\", \"4764\",\n      \"4767\", \"4768\", \"4769\", \"4770\", \"4771\", \"4798\", \"4799\", \"4817\",\n      \"4904\", \"4905\", \"4907\", \"4912\", \"5140\", \"5145\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.winlog?.event_data?.ProcessId != null) {\n  if (ctx?.process == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"process\", hm);\n  }\n  if (ctx.winlog.event_data.ProcessId instanceof String) {\n    Long pid = Long.decode(ctx.winlog.event_data.ProcessId);\n    ctx.process.put(\"pid\", pid.longValue());\n  } else {\n    ctx.process.put(\"pid\", ctx.winlog.event_data.ProcessId);\n  }\n  ctx.winlog.event_data.remove(\"ProcessId\");\n}\nif (ctx?.winlog?.event_data?.ProcessName != null) {\n  if (ctx?.process == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"process\", hm);\n  }\n  ctx.process.put(\"executable\", ctx.winlog.event_data.ProcessName);\n  ctx.winlog.event_data.remove(\"ProcessName\");\n}\nif (ctx?.winlog?.event_data?.IpAddress != null &&\n    ctx.winlog.event_data.IpAddress != \"-\") {\n  if (ctx?.source == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"source\", hm);\n  }\n  ctx.source.put(\"ip\", ctx.winlog.event_data.IpAddress);\n  ctx.winlog.event_data.remove(\"IpAddress\");\n}\nif (ctx?.winlog?.event_data?.IpPort != null && ctx.winlog.event_data.IpPort != \"-\") {\n  if (ctx?.source == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"source\", hm);\n  }\n  ctx.source.put(\"port\", Long.decode(ctx.winlog.event_data.IpPort));\n  ctx.winlog.event_data.remove(\"IpPort\");\n}\nif (ctx?.winlog?.event_data?.WorkstationName != null) {\n  if (ctx?.source == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"source\", hm);\n  }\n  ctx.source.put(\"domain\", ctx.winlog.event_data.WorkstationName);\n  ctx.winlog.event_data.remove(\"WorkstationName\");\n}\nif (ctx?.winlog?.event_data?.ClientAddress != null &&\n    ctx.winlog.event_data.ClientAddress != \"-\") {\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  ctx.related.put(\"ip\", ctx.winlog.event_data.ClientAddress);\n  ctx.winlog.event_data.remove(\"ClientAddress\");\n}\nif (ctx?.process?.name == null && ctx?.process?.executable != null) {\n  def parts = ctx.process.executable.splitOnToken(\"\\\\\");\n  ctx.process.put(\"name\", parts[-1]);\n}",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Rename Common Auth Fields"
        }
      },
      {
        "script" : {
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Process Event 4688",
          "description" : "Process Event 4688",
          "source" : "if (ctx?.event?.code == null ||\n    ![\"4688\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.winlog?.event_data?.NewProcessId != null) {\n  if (ctx?.process == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"process\", hm);\n  }\n  if (ctx.winlog.event_data.NewProcessId instanceof String) {\n    Long pid = Long.decode(ctx.winlog.event_data.NewProcessId);\n    ctx.process.put(\"pid\", pid.longValue());\n  } else {\n    ctx.process.put(\"pid\", ctx.winlog.event_data.NewProcessId);\n  }\n  ctx.winlog.event_data.remove(\"NewProcessId\");\n}\nif (ctx?.winlog?.event_data?.NewProcessName != null) {\n  if (ctx?.process == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"process\", hm);\n  }\n  ctx.process.put(\"executable\", ctx.winlog.event_data.NewProcessName);\n  ctx.winlog.event_data.remove(\"NewProcessName\");\n}\nif (ctx?.winlog?.event_data?.ParentProcessName != null) {\n  if (ctx?.process == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"process\", hm);\n  }\n  if (ctx?.process?.parent == null) {\n    HashMap hm = new HashMap();\n    ctx.process.put(\"parent\", hm);\n  }\n  ctx.process.parent.put(\"executable\", ctx.winlog.event_data.ParentProcessName);\n  ctx.winlog.event_data.remove(\"ParentProcessName\");\n}\nif (ctx?.process?.name == null && ctx?.process?.executable != null) {\n  def parts = ctx.process.executable.splitOnToken(\"\\\\\");\n  ctx.process.put(\"name\", parts[-1]);\n}\nif (ctx?.process?.parent?.name == null && ctx?.process?.parent?.executable != null) {\n  def parts = ctx.process.parent.executable.splitOnToken(\"\\\\\");\n  ctx.process.parent.put(\"name\", parts[-1]);\n}\nif (ctx?.winlog?.event_data?.ProcessId != null) {\n  if (ctx?.process == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"process\", hm);\n  }\n  if (ctx?.process?.parent == null) {\n    HashMap hm = new HashMap();\n    ctx.process.put(\"parent\", hm);\n  }\n  if (ctx.winlog.event_data.ProcessId instanceof String) {\n    Long pid = Long.decode(ctx.winlog.event_data.ProcessId);\n    ctx.process.parent.put(\"pid\", pid.longValue());\n  } else {\n    ctx.process.parent.put(\"pid\", ctx.winlog.event_data.ProcessId);\n  }\n}\nif (ctx?.winlog?.event_data?.CommandLine != null) {\n  int start = 0;\n  int end = 0;\n  boolean in_quote = false;\n  ArrayList al = new ArrayList();\n  for (int i = 0; i < ctx.winlog.event_data.CommandLine.length(); i++) {\n    end = i;\n    if (Character.compare(ctx.winlog.event_data.CommandLine.charAt(i), \"\\\"\".charAt(0)) == 0) {\n      if (in_quote) {\n        in_quote = false;\n      } else {\n        in_quote = true;\n      }\n    }\n    if (Character.isWhitespace(ctx.winlog.event_data.CommandLine.charAt(i)) && !in_quote) {\n      al.add(ctx.winlog.event_data.CommandLine.substring(start, end));\n      start = i + 1;\n    }\n    if (i == ctx.winlog.event_data.CommandLine.length() - 1) {\n      al.add(ctx.winlog.event_data.CommandLine.substring(start, end + 1));\n    }\n  }\n  if (ctx?.process == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"process\", hm);\n  }\n  ctx.process.put(\"args\", al);\n  ctx.process.put(\"command_line\", ctx.winlog.event_data.CommandLine);\n}\nif ((ctx?.winlog?.event_data?.TargetUserName != null) &&\n    (!ctx.winlog.event_data.TargetUserName.equals(\"-\"))) {\n  if (ctx?.related == null) {\n    HashMap hm = new HashMap();\n    ctx.put(\"related\", hm);\n  }\n  if (ctx?.related?.user == null) {\n    ArrayList al = new ArrayList();\n    ctx.related.put(\"user\", al);\n  }\n  if (!ctx.related.user.contains(ctx.winlog.event_data.TargetUserName)) {\n    ctx.related.user.add(ctx.winlog.event_data.TargetUserName);\n  }\n}"
        }
      },
      {
        "append" : {
          "value" : "{{winlog.event_data.SubjectUserName}}",
          "allow_duplicates" : false,
          "if" : "ctx?.event?.code != null &&\n[\"4624\", \"4648\", \"4797\", \"5379\", \"5380\", \"5381\", \"5382\"].contains(ctx.event.code) &&\nctx?.winlog?.event_data?.SubjectUserName != null &&\nctx.winlog.event_data.SubjectUserName != \"-\"",
          "field" : "related.user"
        }
      },
      {
        "append" : {
          "field" : "related.user",
          "value" : "{{winlog.event_data.TargetUserName}}",
          "allow_duplicates" : false,
          "if" : "ctx?.event?.code != null &&\n[\"4688\", \"4720\", \"4722\", \"4723\", \"4724\", \"4725\", \"4726\", \"4738\",\n \"4740\", \"4767\", \"4797\", \"4798\"].contains(ctx.event.code) &&\nctx?.winlog?.event_data?.TargetUserName != null &&\nctx.winlog.event_data.TargetUserName != \"-\""
        }
      },
      {
        "split" : {
          "field" : "winlog.event_data.PrivilegeList",
          "separator" : "\\s+",
          "if" : "ctx?.event?.code != null &&\n[\"4672\", \"4673\", \"4674\", \"4741\", \"4742\", \"4743\"].contains(ctx.event.code) &&\nctx?.winlog?.event_data?.PrivilegeList != null"
        }
      },
      {
        "set" : {
          "copy_from" : "winlog.event_data.OldTargetUserName",
          "ignore_empty_value" : true,
          "field" : "user.target.name"
        }
      },
      {
        "set" : {
          "copy_from" : "winlog.event_data.NewTargetUserName",
          "ignore_empty_value" : true,
          "field" : "user.changes.name"
        }
      },
      {
        "append" : {
          "field" : "related.user",
          "value" : "{{winlog.event_data.NewTargetUserName}}",
          "allow_duplicates" : false,
          "if" : "ctx?.winlog?.event_data?.NewTargetUserName != null &&\nctx.winlog.event_data.NewTargetUserName != \"-\""
        }
      },
      {
        "append" : {
          "if" : "ctx?.winlog?.event_data?.OldTargetUserName != null &&\nctx.winlog.event_data.OldTargetUserName != \"-\"",
          "field" : "related.user",
          "value" : "{{winlog.event_data.OldTargetUserName}}",
          "allow_duplicates" : false
        }
      },
      {
        "gsub" : {
          "field" : "source.ip",
          "pattern" : "::ffff:",
          "replacement" : "",
          "ignore_missing" : true
        }
      },
      {
        "append" : {
          "field" : "related.ip",
          "value" : "{{source.ip}}",
          "allow_duplicates" : false,
          "if" : "ctx?.source?.ip != null &&\nctx.source.ip != \"-\""
        }
      },
      {
        "script" : {
          "params" : {
            "DomainSpecificSID" : {
              "500" : "Administrator",
              "527" : "Enterprise Key Admins",
              "512" : "Domain Admins",
              "517" : "Cert Publishers",
              "526" : "Key Admins",
              "518" : "Schema Admins",
              "519" : "Enterprise Admins",
              "572" : "Denied RODC Password Replication Group",
              "515" : "Domain Computers",
              "498" : "Enterprise Read-only Domain Controllers",
              "514" : "Domain Guests",
              "520" : "Group Policy Creator Owners",
              "513" : "Domain Users",
              "516" : "Domain Controllers",
              "553" : "RAS and IAS Servers",
              "501" : "Guest",
              "502" : "KRBTGT",
              "522" : "Cloneable Domain Controllers",
              "521" : "Read-only Domain Controllers",
              "571" : "Allowed RODC Password Replication Group"
            },
            "PermissionDescription" : {
              "KW" : "KEY WRITE",
              "LC" : "List Contents",
              "KX" : "KEY EXECUTE",
              "GX" : "Generic Execute",
              "RP" : "Read All Properties",
              "WP" : "Write All Properties",
              "LO" : "List Object",
              "FW" : "FILE GENERIC WRITE",
              "FA" : "File All Access",
              "GW" : "Generic Write",
              "SD" : "Delete",
              "DC" : "Delete All Child Objects",
              "KR" : "KEY READ",
              "FX" : "FILE GENERIC EXECUTE",
              "GA" : "Generic All",
              "WO" : "Modify Owner",
              "CR" : "All Extended Rights",
              "KA" : "KEY ALL ACCESS",
              "CC" : "Create All Child Objects",
              "DT" : "Delete Subtree",
              "RC" : "Read Permissions",
              "GR" : "Generic Read",
              "SW" : "All Validated",
              "WD" : "Modify Permissions",
              "FR" : "File Generic Read"
            },
            "PermsFlags" : {
              "0x80000000" : "Generic Read",
              "0x00080000" : "Write Owner",
              "0x00020000" : "Read Control",
              "0x10000000" : "Generic All",
              "0x00010000" : "Delete",
              "0x4000000" : "Generic Write",
              "0x20000000" : "Generic Execute",
              "0x02000000" : "Maximum Allowed",
              "0x01000000" : "Access System Security",
              "0x00100000" : "Syncronize",
              "0x00040000" : "Write DACL"
            },
            "AccountSIDDescription" : {
              "S-1-5-10" : "Principal Self",
              "S-1-5-32-576" : "Builtin\\RDS Endpoint Servers",
              "S-1-5-32-561" : "Builtin\\Terminal Server License Servers",
              "S-1-16-8448" : "Medium Plus Mandatory Level",
              "S-1-1" : "World Authority",
              "S-1-16-12288" : "High Mandatory Level",
              "S-1-5-32-558" : "Builtin\\Performance Monitor Users",
              "S-1-5-32-578" : "Builtin\\Hyper-V Administrators",
              "S-1-5-32-556" : "Builtin\\Network Configuration Operators",
              "S-1-5-32-574" : "Builtin\\Certificate Service DCOM Access",
              "S-1-5-17" : "This Organization",
              "S-1-5-83-0" : "NT Virtual Machine\\Virtual Machines",
              "LS" : "Local service account",
              "RE" : "Replicator",
              "S-1-5-32-554" : "Builtin\\Pre-Windows 2000 Compatible Access",
              "S-1-5-13" : "Terminal Server Users",
              "SA" : "Schema administrators",
              "S-1-3-1" : "Creator Group",
              "S-1-3-3" : "Creator Group Server",
              "WD" : "Everyone",
              "S-1-3-0" : "Creator Owner",
              "S-1-2-0" : "Local",
              "PU" : "Power users",
              "S-1-5-9" : "Enterprise Domain Controllers",
              "BG" : "Built-in guests",
              "S-1-3-4" : "Owner Rights",
              "CG" : "Creator group",
              "S-1-5-3" : "Batch",
              "S-1-5-32-545" : "Users",
              "S-1-5-32-557" : "Builtin\\Incoming Forest Trust Builders",
              "DC" : "Domain computers",
              "NS" : "Network service account",
              "S-1-0-0" : "Nobody",
              "DG" : "Domain guests",
              "S-1-5-8" : "Proxy",
              "BA" : "Built-in administrators",
              "S-1-5-32-577" : "Builtin\\RDS Management Servers",
              "S-1-5-32-548" : "Account Operators",
              "BU" : "Built-in users",
              "S-1-5-32-551" : "Backup Operators",
              "S-1-3" : "Creator Authority",
              "SU" : "Service logon user",
              "SY" : "Local system",
              "S-1-5" : "NT Authority",
              "S-1-5-6" : "Service",
              "S-1-5-15" : "This Organization",
              "S-1-5-64-14" : "SChannel Authentication",
              "S-1-5-32-562" : "Builtin\\Distributed COM Users",
              "S-1-5-2" : "Network",
              "S-1-5-32-573" : "Builtin\\Event Log Readers",
              "S-1-1-0" : "Everyone",
              "S-1-2" : "Local Authority",
              "S-1-5-5-X-Y" : "Logon Session",
              "RC" : "Restricted code",
              "NO" : "Network configuration operators",
              "S-1-5-7" : "Anonymous",
              "PS" : "Personal self",
              "S-1-0" : "Null Authority",
              "S-1-5-32-552" : "Replicators",
              "SO" : "Server operators",
              "S-1-16-20480" : "Protected Process Mandatory Level",
              "ED" : "Enterprise domain controllers",
              "S-1-5-32-569" : "Builtin\\Cryptographic Operators",
              "S-1-3-2" : "Creator Owner Server",
              "S-1-5-64-10" : "NTLM Authentication",
              "DU" : "Domain users",
              "S-1-5-32-550" : "Print Operators",
              "S-1-5-1" : "Dialup",
              "S-1-5-32-582" : "Storage Replica Administrators",
              "DA" : "Domain administrators",
              "S-1-5-32-549" : "Server Operators",
              "AN" : "Anonymous logon",
              "S-1-5-32-559" : "Builtin\\Performance Log Users",
              "IU" : "Interactively logged-on user",
              "S-1-5-90-0" : "Windows Manager\\Windows Manager Group",
              "S-1-16-28672" : "Secure Process Mandatory Level",
              "EA" : "Enterprise administrators",
              "S-1-16-4096" : "Low Mandatory Level",
              "S-1-5-80" : "NT Service",
              "S-1-5-32-547" : "Power Users",
              "S-1-5-18" : "Local System",
              "S-1-5-12" : "Restricted Code",
              "DD" : "Domain controllers",
              "PO" : "Printer operators",
              "S-1-5-32-560" : "Builtin\\Windows Authorization Access Group",
              "RS" : "RAS servers group",
              "LA" : "Local administrator",
              "S-1-2-1" : "Console Logon",
              "S-1-16-16384" : "System Mandatory Level",
              "S-1-5-64-21" : "Digest Authentication",
              "PA" : "Group Policy administrators",
              "CA" : "Certificate server administrators",
              "LG" : "Local guest",
              "S-1-5-80-0" : "All Services",
              "RD" : "Terminal server users",
              "S-1-5-11" : "Authenticated Users",
              "S-1-5-32-580" : "Builtin\\Remote Management Users",
              "BO" : "Backup operators",
              "S-1-16-8192" : "Medium Mandatory Level",
              "CO" : "Creator owner",
              "S-1-5-14" : "Remote Interactive Logon",
              "S-1-4" : "Non-unique Authority",
              "S-1-16-0" : "Untrusted Mandatory Level",
              "S-1-5-32-544" : "Administrators",
              "S-1-5-32-579" : "Builtin\\Access Control Assistance Operators",
              "S-1-5-20" : "NT Authority",
              "S-1-5-32-555" : "Builtin\\Remote Desktop Users",
              "RU" : "Alias to allow previous Windows 2000",
              "AU" : "Authenticated users",
              "S-1-5-19" : "NT Authority",
              "S-1-5-4" : "Interactive",
              "S-1-5-32-546" : "Guests",
              "S-1-5-32-575" : "Builtin\\RDS Remote Access Servers",
              "AO" : "Account operators",
              "NU" : "Network logon user"
            },
            "AceTypes" : {
              "AL" : "System Alarm",
              "OU" : "System Object Audit",
              "SP" : "Central Policy ID",
              "D" : "Access Denied",
              "OA" : "Object Access Allowed",
              "OD" : "Object Access Denied",
              "AU" : "System Audit",
              "OL" : "System Object Alarm",
              "ML" : "System Mandatory Label",
              "A" : "Access Allowed"
            }
          },
          "source" : "ArrayList translatePermissionMask(def mask, def params) {\n  ArrayList al = new ArrayList();\n  Long permCode = Long.decode(mask);\n  for (entry in params.PermsFlags.entrySet()) {\n    Long permFlag = Long.decode(entry.getKey());\n    if ((permCode.longValue() & permFlag.longValue()) == permFlag.longValue()) {\n      al.add(entry.getValue());\n    }\n  }\n  if (al.length == 0) {\n    al.add(mask);\n  }\n  return al;\n}\n\nHashMap translateACL(def dacl, def params) {\n  def aceArray = dacl.splitOnToken(\";\");\n  HashMap hm = new HashMap();\n\n  if (aceArray.length >= 6 ) {\n    hm.put(\"grantee\", translateSID(aceArray[5], params));\n  }\n\n  if (aceArray.length >= 1) {\n    hm.put(\"type\", params.AceTypes[aceArray[0]]);\n  }\n\n  if (aceArray.length >= 3) {\n    if (aceArray[2].startsWith(\"0x\")) {\n      hm.put(\"perms\", translatePermissionMask(aceArray[2], params));\n    } else {\n      ArrayList al = new ArrayList();\n      Pattern permPattern = /.{1,2}/;\n      Matcher permMatcher = permPattern.matcher(aceArray[2]);\n      while (permMatcher.find()) {\n        al.add(params.PermissionDescription[permMatcher.group(0)]);\n      }\n      hm.put(\"perms\", al);\n    }\n  }\n  return hm;\n}\nString translateSID(def sid, def params) {\n  if (!params.AccountSIDDescription.containsKey(sid)) {\n    if (sid.startsWith(\"S-1-5-21\")) {\n      Pattern uidPattern = /[0-9]{1,5}$/;\n      Matcher uidMatcher = uidPattern.matcher(sid);\n      if (uidMatcher.find()) {\n        return params.DomainSpecificSID[uidMatcher.group(0)];\n      }\n      return sid;\n    }\n    return sid;\n  }\n  return params.AccountSIDDescription[sid];\n}\n\nvoid enrichSDDL(def sddlStr, def Sd, def params, def ctx) {\n  Pattern sdOwnerPattern = /^O\\:[A-Z]{2}/;\n  Matcher sdOwnerMatcher = sdOwnerPattern.matcher(sddlStr);\n  if (sdOwnerMatcher.find()) {\n    ctx.winlog.event_data.put(Sd + \"Owner\", translateSID(sdOwnerMatcher.group(0), params));\n  }\n\n  Pattern sdGroupPattern = /^G\\:[A-Z]{2}/;\n  Matcher sdGroupMatcher = sdGroupPattern.matcher(sddlStr);\n  if (sdGroupMatcher.find()) {\n    ctx.winlog.event_data.put(Sd + \"Group\", translateSID(sdGroupMatcher.group(0), params));\n  }\n\n  Pattern sdDaclPattern = /(D:([A-Z]*(\\(.*\\))*))/;\n  Matcher sdDaclMatcher = sdDaclPattern.matcher(sddlStr);\n  if (sdDaclMatcher.find()) {\n    Pattern dacListPattern = /\\([^*\\)]*\\)/;\n    Matcher dacListMatcher = dacListPattern.matcher(sdDaclMatcher.group(1));\n    for (def i = 0; dacListMatcher.find(); i++) {\n      def newDacl = translateACL(dacListMatcher.group(0).replace(\"(\",\"\").replace(\")\",\"\"), params);\n      ctx.winlog.event_data.put(Sd + \"Dacl\" + i.toString(), newDacl['grantee'] + \" :\" + newDacl['type'] + \" (\" + newDacl['perms'] + \")\");\n      if ([\"Administrator\", \"Guest\", \"KRBTGT\"].contains(newDacl['grantee'])) {\n        if (ctx?.related == null) {\n          HashMap hm = new HashMap();\n          ctx.put(\"related\", hm);\n        }\n        if (ctx?.related?.user == null) {\n          ArrayList al = new ArrayList();\n          ctx.related.put(\"user\", al);\n        }\n        if (!ctx.related.user.contains(newDacl['grantee'])) {\n          ctx.related.user.add(newDacl['grantee']);\n        }\n      }\n    }\n  }\n\n  Pattern sdSaclPattern = /(S:([A-Z]*(\\(.*\\))*))?$/;\n  Matcher sdSaclMatcher = sdSaclPattern.matcher(sddlStr);\n  if (sdSaclMatcher.find()) {\n    Pattern sacListPattern = /\\([^*\\)]*\\)/;\n    Matcher sacListMatcher = sacListPattern.matcher(sdSaclMatcher.group(0));\n    for (def i = 0; sacListMatcher.find(); i++) {\n      def newSacl = translateACL(sacListMatcher.group(0).replace(\"(\",\"\").replace(\")\",\"\"), params);\n      ctx.winlog.event_data.put(Sd + \"Sacl\" + i.toString(), newSacl['grantee'] + \" :\" + newSacl['type'] + \" (\" + newSacl['perms'] + \")\");\n      if ([\"Administrator\", \"Guest\", \"KRBTGT\"].contains(newSacl['grantee'])) {\n        if (ctx?.related == null) {\n          HashMap hm = new HashMap();\n          ctx.put(\"related\", hm);\n        }\n        if (ctx?.related?.user == null) {\n          ArrayList al = new ArrayList();\n          ctx.related.put(\"user\", al);\n        }\n        if (!ctx.related.user.contains(newSacl['grantee'])) {\n          ctx.related.user.add(newSacl['grantee']);\n        }\n      }\n    }\n  }\n}\n\ndef split(String s) {\n  def f = new ArrayList();\n  int last = 0;\n  for (; last < s.length() && Character.isWhitespace(s.charAt(last)); last++) {}\n  for (def i = last; i < s.length(); i++) {\n    if (!Character.isWhitespace(s.charAt(i))) {\n      continue;\n    }\n    f.add(s.substring(last, i));\n    for (; i < s.length() && Character.isWhitespace(s.charAt(i)); i++) {}\n    last = i;\n  }\n  f.add(s.substring(last));\n  return f;\n}\n\nvoid splitSidList(def sids, def params, def ctx) {\n  ArrayList list = new ArrayList();\n  ArrayList desc = new ArrayList();\n  def sidList = split(sids);\n  for (def i = 0; i < sidList.length; i++) {\n    list.add(sidList[i]);\n    desc.add(translateSID(sidList[i].replace(\"%\", \"\").replace(\"{\", \"\").replace(\"}\", \"\"), params));\n  }\n  ctx.winlog.event_data.put(\"SidList\", list);\n  ctx.winlog.event_data.put(\"SidListDesc\", desc);\n}\n\nif (ctx?.event?.code == null ||\n    ![\"4670\", \"4817\", \"4907\", \"4908\"].contains(ctx.event.code)) {\n  return;\n}\nif (ctx?.winlog?.event_data?.OldSd != null) {\n  enrichSDDL(ctx.winlog.event_data.OldSd, \"OldSd\", params, ctx);\n}\nif (ctx?.winlog?.event_data?.NewSd != null) {\n  enrichSDDL(ctx.winlog.event_data.NewSd, \"NewSd\", params, ctx);\n}\nif (ctx?.winlog?.event_data?.SidList != null) {\n  splitSidList(ctx.winlog.event_data.SidList, params, ctx);\n}",
          "lang" : "painless",
          "ignore_failure" : false,
          "tag" : "Object Policy Change and SidListDesc",
          "description" : "Object Policy Change and SidListDesc"
        }
      },
      {
        "set" : {
          "copy_from" : "winlog.event_data.RelativeTargetName",
          "if" : "ctx.event?.code != null &&\n[\"5140\", \"5145\"].contains(ctx.event.code) &&\nctx.winlog?.event_data?.RelativeTargetName != null &&\nctx.winlog.event_data.RelativeTargetName != \"\"",
          "field" : "file.name"
        }
      },
      {
        "set" : {
          "if" : "ctx.event?.code != null &&\n[\"5140\", \"5145\"].contains(ctx.event.code) &&\nctx.winlog?.event_data?.ShareLocalPath != null &&\nctx.winlog.event_data.ShareLocalPath != \"\"",
          "field" : "file.directory",
          "copy_from" : "winlog.event_data.ShareLocalPath"
        }
      },
      {
        "set" : {
          "field" : "file.path",
          "value" : "{{file.directory}}\\{{file.name}}",
          "if" : "ctx.file?.name != null && ctx.file?.directory != null"
        }
      },
      {
        "set" : {
          "if" : "ctx.event?.code != null &&\n[\"5140\", \"5145\"].contains(ctx.event.code) &&\nctx.winlog?.event_data?.ShareLocalPath != null &&\nctx.winlog.event_data.ShareLocalPath != \"\"",
          "field" : "file.directory",
          "copy_from" : "winlog.event_data.ShareLocalPath"
        }
      },
      {
        "set" : {
          "field" : "file.target_path",
          "value" : "{{winlog.event_data.ShareName}}\\{{file.name}}",
          "if" : "ctx.event?.code != null &&\n[\"5140\", \"5145\"].contains(ctx.event.code) &&\nctx.winlog?.event_data?.ShareName != null &&\nctx.winlog.event_data.ShareName != \"\" &&\nctx.file?.name != null"
        }
      },
      {
        "script" : {
          "description" : "Adds file information.",
          "lang" : "painless",
          "if" : "ctx.file?.name != null",
          "source" : "def extIdx = ctx.file.name.lastIndexOf(\".\");\nif (extIdx > -1) {\n    ctx.file.extension = ctx.file.name.substring(extIdx+1);\n}"
        }
      },
      {
        "convert" : {
          "ignore_missing" : true,
          "field" : "winlog.record_id",
          "type" : "string"
        }
      },
      {
        "convert" : {
          "ignore_missing" : true,
          "field" : "winlog.event_id",
          "type" : "string"
        }
      },
      {
        "set" : {
          "field" : "ecs.version",
          "value" : "1.12.0"
        }
      },
      {
        "set" : {
          "field" : "log.level",
          "copy_from" : "winlog.level",
          "ignore_empty_value" : true,
          "ignore_failure" : true,
          "if" : "ctx?.winlog?.level != \"\""
        }
      },
      {
        "date" : {
          "field" : "winlog.time_created",
          "formats" : [
            "ISO8601"
          ],
          "ignore_failure" : true,
          "if" : "ctx?.winlog?.time_created != null"
        }
      },
      {
        "remove" : {
          "field" : "event.original",
          "if" : "ctx?.tags == null || !(ctx.tags.contains('preserve_original_event'))",
          "ignore_failure" : true,
          "ignore_missing" : true
        }
      }
    ],
    "on_failure" : [
      {
        "set" : {
          "field" : "error.message",
          "value" : "Processor \"{{ _ingest.on_failure_processor_type }}\" with tag \"{{ _ingest.on_failure_processor_tag }}\" in pipeline \"{{ _ingest.on_failure_pipeline }}\" failed with message \"{{ _ingest.on_failure_message }}\""
        }
      }
    ]
  }
